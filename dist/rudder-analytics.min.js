var rudderanalytics=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e){return function(e){if(Array.isArray(e))return c(e)}(e)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||function(e,t){if(!e)return;if("string"==typeof e)return c(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return c(e,t)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function c(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var l=4,d=function(e){switch(e.toUpperCase()){case"INFO":return void(l=1);case"DEBUG":return void(l=2);case"WARN":return void(l=3)}},f=function(){var e;l<=2&&(e=console).debug.apply(e,arguments)},p=function(){var e;l<=4&&(e=console).error.apply(e,arguments)};function h(e,t){return null==t?void 0:t}function g(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}function y(){return(new Date).toISOString()}function m(e){var t=e.message?e.message:void 0;e instanceof Event&&e.target&&"script"==e.target.localName&&(t="error in script loading: "+e.target.id),t&&p("[Util] handleError:: ",t)}function v(){var e=b(),t=e?e.pathname:window.location.pathname,n=document.referrer,r=window.location.search;return{path:t,referrer:n,search:r,title:document.title,url:function(e){var t=b(),n=t?t.indexOf("?")>-1?t:t+e:window.location.href,r=n.indexOf("#");return r>-1?n.slice(0,r):n}(r)}}function b(){for(var e,t=document.getElementsByTagName("link"),n=0;e=t[n];n++)if("canonical"===e.getAttribute("rel"))return e.getAttribute("href")}function w(e,t){var n=e.revenue;return!n&&t&&t.match(/^[ _]?completed[ _]?order[ _]?|^[ _]?order[ _]?completed[ _]?$/i)&&(n=e.total),function(e){if(e){if("number"==typeof e)return e;if("string"==typeof e)return e=e.replace(/\$/g,""),e=parseFloat(e),isNaN(e)?void 0:e}}(n)}var k={TRACK:"track",PAGE:"page",IDENTIFY:"identify"},_={PRODUCTS_SEARCHED:"Products Searched",PRODUCT_LIST_VIEWED:"Product List Viewed",PRODUCT_LIST_FILTERED:"Product List Filtered",PROMOTION_VIEWED:"Promotion Viewed",PROMOTION_CLICKED:"Promotion Clicked",PRODUCT_CLICKED:"Product Clicked",PRODUCT_VIEWED:"Product Viewed",PRODUCT_ADDED:"Product Added",PRODUCT_REMOVED:"Product Removed",CART_VIEWED:"Cart Viewed",CHECKOUT_STARTED:"Checkout Started",CHECKOUT_STEP_VIEWED:"Checkout Step Viewed",CHECKOUT_STEP_COMPLETED:"Checkout Step Completed",PAYMENT_INFO_ENTERED:"Payment Info Entered",ORDER_UPDATED:"Order Updated",ORDER_COMPLETED:"Order Completed",ORDER_REFUNDED:"Order Refunded",ORDER_CANCELLED:"Order Cancelled",COUPON_ENTERED:"Coupon Entered",COUPON_APPLIED:"Coupon Applied",COUPON_DENIED:"Coupon Denied",COUPON_REMOVED:"Coupon Removed",PRODUCT_ADDED_TO_WISHLIST:"Product Added to Wishlist",PRODUCT_REMOVED_FROM_WISHLIST:"Product Removed from Wishlist",WISH_LIST_PRODUCT_ADDED_TO_CART:"Wishlist Product Added to Cart",PRODUCT_SHARED:"Product Shared",CART_SHARED:"Cart Shared",PRODUCT_REVIEWED:"Product Reviewed"};function I(e,t){f("in script loader=== "+e);var n=document.createElement("script");n.src=t,n.type="text/javascript",n.id=e;var r=document.getElementsByTagName("script")[0];f("==script==",r),r.parentNode.insertBefore(n,r)}var E=function(){function e(t){n(this,e),this.hubId=t.hubID,this.name="HS"}return i(e,[{key:"init",value:function(){I("hubspot-integration","http://js.hs-scripts.com/"+this.hubId+".js"),f("===in init HS===")}},{key:"identify",value:function(e){f("in HubspotAnalyticsManager identify");var n=e.message.context.traits,r={};for(var i in n)if(Object.getOwnPropertyDescriptor(n,i)&&n[i]){var o=i;"[object Date]"==toString.call(n[i])?r[o]=n[i].getTime():r[o]=n[i]}var s=e.message.context.user_properties;for(var a in s){if(Object.getOwnPropertyDescriptor(s,a)&&s[a])r[a]=s[a]}(f(r),void 0!==("undefined"==typeof window?"undefined":t(window)))&&(window._hsq=window._hsq||[]).push(["identify",r])}},{key:"track",value:function(e){f("in HubspotAnalyticsManager track");var t=window._hsq=window._hsq||[],n={};n.id=e.message.event,e.message.properties&&(e.message.properties.revenue||e.message.properties.value)&&(n.value=e.message.properties.revenue||e.message.properties.value),t.push(["trackEvent",n])}},{key:"page",value:function(e){f("in HubspotAnalyticsManager page");var t=window._hsq=window._hsq||[];e.message.properties&&e.message.properties.path&&t.push(["setPath",e.message.properties.path]),t.push(["trackPageView"])}},{key:"isLoaded",value:function(){return f("in hubspot isLoaded"),!(!window._hsq||window._hsq.push===Array.prototype.push)}},{key:"isReady",value:function(){return!(!window._hsq||window._hsq.push===Array.prototype.push)}}]),e}(),A=function(){function e(t){n(this,e),this.trackingID=t.trackingID,this.allowLinker=t.allowLinker||!1,this.name="GA"}return i(e,[{key:"init",value:function(){!function(e,t,n,r,i,o,s){e.GoogleAnalyticsObject=i,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,o=t.createElement(n),s=t.getElementsByTagName(n)[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(o,s)}(window,document,"script",0,"ga"),ga("create",this.trackingID,"auto","rudder_ga",{allowLinker:this.allowLinker}),f("===in init GA===")}},{key:"setUserId",value:function(e){var t=""!==e.message.userId?e.message.userId:e.message.anonymousId;ga("rudder_ga.set","userId",t)}},{key:"identify",value:function(e){this.setUserId(e),f("in GoogleAnalyticsManager identify")}},{key:"track",value:function(e){var t=e.message.event,n=e.message.event,r=e.message.event,i="";e.message.properties&&(i=e.message.properties.value?e.message.properties.value:e.message.properties.revenue,t=e.message.properties.category?e.message.properties.category:t,r=e.message.properties.label?e.message.properties.label:r);var o={hitType:"event",eventCategory:t,eventAction:n,eventLabel:r,eventValue:i};this.setUserId(e),ga("rudder_ga.send","event",o),f("in GoogleAnalyticsManager track")}},{key:"page",value:function(e){f("in GoogleAnalyticsManager page");var t=e.message.properties&&e.message.properties.path?e.message.properties.path:void 0,n=e.message.properties&&e.message.properties.title?e.message.properties.title:void 0,r=e.message.properties&&e.message.properties.url?e.message.properties.url:void 0;t&&ga("rudder_ga.set","page",t),n&&ga("rudder_ga.set","title",n),r&&ga("rudder_ga.set","location",r),this.setUserId(e),ga("rudder_ga.send","pageview")}},{key:"isLoaded",value:function(){return f("in GA isLoaded"),!!window.gaplugins}},{key:"isReady",value:function(){return!!window.gaplugins}}]),e}(),T=function(){function e(t){n(this,e),this.siteId=t.siteID,this.name="HOTJAR",this._ready=!1}return i(e,[{key:"init",value:function(){window.hotjarSiteId=this.siteId,function(e,t,n,r,i,o){e.hj=e.hj||function(){(e.hj.q=e.hj.q||[]).push(arguments)},e._hjSettings={hjid:e.hotjarSiteId,hjsv:6},i=t.getElementsByTagName("head")[0],(o=t.createElement("script")).async=1,o.src="https://static.hotjar.com/c/hotjar-"+e._hjSettings.hjid+".js?sv="+e._hjSettings.hjsv,i.appendChild(o)}(window,document),this._ready=!0,f("===in init Hotjar===")}},{key:"identify",value:function(e){if(e.message.userId||e.message.anonymousId){var t=e.message.context.traits;window.hj("identify",e.message.userId,t)}else f("[Hotjar] identify:: user id is required")}},{key:"track",value:function(e){f("[Hotjar] track:: method not supported")}},{key:"page",value:function(e){f("[Hotjar] page:: method not supported")}},{key:"isLoaded",value:function(){return this._ready}},{key:"isReady",value:function(){return this._ready}}]),e}(),C=function(){function e(t){n(this,e),this.conversionId=t.conversionID,this.pageLoadConversions=t.pageLoadConversions,this.clickEventConversions=t.clickEventConversions,this.name="GOOGLEADS"}return i(e,[{key:"init",value:function(){!function(e,t,n){f("in script loader=== "+e);var r=n.createElement("script");r.src=t,r.async=1,r.type="text/javascript",r.id=e;var i=n.getElementsByTagName("head")[0];f("==script==",i),i.appendChild(r)}("googleAds-integration","https://www.googletagmanager.com/gtag/js?id="+this.conversionId,document),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},window.gtag("js",new Date),window.gtag("config",this.conversionId),f("===in init Google Ads===")}},{key:"identify",value:function(e){f("[GoogleAds] identify:: method not supported")}},{key:"track",value:function(e){f("in GoogleAdsAnalyticsManager track");var t=this.getConversionData(this.clickEventConversions,e.message.event);if(t.conversionLabel){var n=t.conversionLabel,r=t.eventName,i=this.conversionId+"/"+n,o={};e.properties&&(o.value=e.properties.revenue,o.currency=e.properties.currency,o.transaction_id=e.properties.order_id),o.send_to=i,window.gtag("event",r,o)}}},{key:"page",value:function(e){f("in GoogleAdsAnalyticsManager page");var t=this.getConversionData(this.pageLoadConversions,e.message.name);if(t.conversionLabel){var n=t.conversionLabel,r=t.eventName;window.gtag("event",r,{send_to:this.conversionId+"/"+n})}}},{key:"getConversionData",value:function(e,t){var n={};return e&&e.forEach((function(e){if(e.name.toLowerCase()===t.toLowerCase())return n.conversionLabel=e.conversionLabel,void(n.eventName=e.name)})),n}},{key:"isLoaded",value:function(){return window.dataLayer.push!==Array.prototype.push}},{key:"isReady",value:function(){return window.dataLayer.push!==Array.prototype.push}}]),e}(),O=function(){function e(t){n(this,e),this.accountId=t.accountId,this.settingsTolerance=t.settingsTolerance,this.isSPA=t.isSPA,this.libraryTolerance=t.libraryTolerance,this.useExistingJquery=t.useExistingJquery,this.sendExperimentTrack=t.sendExperimentTrack,this.sendExperimentIdentify=t.sendExperimentIdentify,this.name="VWO",f("Config ",t)}return i(e,[{key:"init",value:function(){f("===in init VWO===");var e=this.accountId,t=this.settingsTolerance,n=this.libraryTolerance,r=this.useExistingJquery,i=this.isSPA;window._vwo_code=function(){var o=!1,s=document;return{use_existing_jquery:function(){return r},library_tolerance:function(){return n},finish:function(){if(!o){o=!0;var e=s.getElementById("_vis_opt_path_hides");e&&e.parentNode.removeChild(e)}},finished:function(){return o},load:function(e){var t=s.createElement("script");t.src=e,t.type="text/javascript",t.innerText,t.onerror=function(){_vwo_code.finish()},s.getElementsByTagName("head")[0].appendChild(t)},init:function(){var n=setTimeout("_vwo_code.finish()",t),r=s.createElement("style"),o="body{opacity:0 !important;filter:alpha(opacity=0) !important;background:none !important;}",a=s.getElementsByTagName("head")[0];return r.setAttribute("id","_vis_opt_path_hides"),r.setAttribute("type","text/css"),r.styleSheet?r.styleSheet.cssText=o:r.appendChild(s.createTextNode(o)),a.appendChild(r),this.load("//dev.visualwebsiteoptimizer.com/j.php?a="+e+"&u="+encodeURIComponent(s.URL)+"&r="+Math.random()+"&f="+ +i),n}}}(),window._vwo_settings_timer=window._vwo_code.init(),(this.sendExperimentTrack||this.experimentViewedIdentify)&&this.experimentViewed()}},{key:"experimentViewed",value:function(){window.VWO=window.VWO||[];var e=this;window.VWO.push(["onVariationApplied",function(t){if(t){f("Variation Applied");var n=t[1],r=t[2];if(f("experiment id:",n,"Variation Name:",_vwo_exp[n].comb_n[r]),void 0!==_vwo_exp[n].comb_n[r]&&["VISUAL_AB","VISUAL","SPLIT_URL","SURVEY"].indexOf(_vwo_exp[n].type)>-1){try{e.sendExperimentTrack&&(f("Tracking..."),window.rudderanalytics.track("Experiment Viewed",{experimentId:n,variationName:_vwo_exp[n].comb_n[r]}))}catch(e){p("[VWO] experimentViewed:: ",e)}try{e.sendExperimentIdentify&&(f("Identifying..."),window.rudderanalytics.identify(o({},"Experiment: ".concat(n),_vwo_exp[n].comb_n[r])))}catch(e){p("[VWO] experimentViewed:: ",e)}}}}])}},{key:"identify",value:function(e){f("method not supported")}},{key:"track",value:function(e){if("Order Completed"===e.message.event){var t=e.message.properties?e.message.properties.total||e.message.properties.revenue:0;f("Revenue",t),window.VWO=window.VWO||[],window.VWO.push(["track.revenueConversion",t])}}},{key:"page",value:function(e){f("method not supported")}},{key:"isLoaded",value:function(){return!!window._vwo_code}},{key:"isReady",value:function(){return!!window._vwo_code}}]),e}(),S=function(){function e(t){n(this,e),this.containerID=t.containerID,this.name="GOOGLETAGMANAGER"}return i(e,[{key:"init",value:function(){f("===in init GoogleTagManager==="),function(e,t,n,r,i){e[r]=e[r]||[],e[r].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var o=t.getElementsByTagName(n)[0],s=t.createElement(n);s.async=!0,s.src="https://www.googletagmanager.com/gtm.js?id="+i,o.parentNode.insertBefore(s,o)}(window,document,"script","dataLayer",this.containerID)}},{key:"identify",value:function(e){f("[GTM] identify:: method not supported")}},{key:"track",value:function(e){f("===in track GoogleTagManager===");var t=e.message,n=a({event:t.event,userId:t.userId,anonymousId:t.anonymousId},t.properties);this.sendToGTMDatalayer(n)}},{key:"page",value:function(e){f("===in page GoogleTagManager===");var t,n=e.message,r=n.name,i=n.properties?n.properties.category:void 0;r&&(t="Viewed "+r+" page"),i&&r&&(t="Viewed "+i+" "+r+" page");var o=a({event:t,userId:n.userId,anonymousId:n.anonymousId},n.properties);this.sendToGTMDatalayer(o)}},{key:"isLoaded",value:function(){return!(!window.dataLayer||Array.prototype.push===window.dataLayer.push)}},{key:"sendToGTMDatalayer",value:function(e){window.dataLayer.push(e)}},{key:"isReady",value:function(){return!(!window.dataLayer||Array.prototype.push===window.dataLayer.push)}}]),e}(),j=function(){function e(t,r){if(n(this,e),this.analytics=r,this.appKey=t.appKey,t.appKey||(this.appKey=""),this.endPoint="",t.dataCenter){var i=t.dataCenter.trim().split("-");"eu"===i[0].toLowerCase()?this.endPoint="sdk.fra-01.braze.eu":this.endPoint="sdk.iad-"+i[1]+".braze.com"}this.name="BRAZE",f("Config ",t)}return i(e,[{key:"formatGender",value:function(e){if(e&&"string"==typeof e){return["woman","female","w","f"].indexOf(e.toLowerCase())>-1?window.appboy.ab.User.Genders.FEMALE:["man","male","m"].indexOf(e.toLowerCase())>-1?window.appboy.ab.User.Genders.MALE:["other","o"].indexOf(e.toLowerCase())>-1?window.appboy.ab.User.Genders.OTHER:void 0}}},{key:"init",value:function(){f("===in init Braze==="),function(e,t,n,r,i){e.appboy={},e.appboyQueue=[];for(var o="initialize destroy getDeviceId toggleAppboyLogging setLogger openSession changeUser requestImmediateDataFlush requestFeedRefresh subscribeToFeedUpdates requestContentCardsRefresh subscribeToContentCardsUpdates logCardImpressions logCardClick logCardDismissal logFeedDisplayed logContentCardsDisplayed logInAppMessageImpression logInAppMessageClick logInAppMessageButtonClick logInAppMessageHtmlClick subscribeToNewInAppMessages subscribeToInAppMessage removeSubscription removeAllSubscriptions logCustomEvent logPurchase isPushSupported isPushBlocked isPushGranted isPushPermissionGranted registerAppboyPushMessages unregisterAppboyPushMessages trackLocation stopWebTracking resumeWebTracking wipeData ab ab.DeviceProperties ab.User ab.User.Genders ab.User.NotificationSubscriptionTypes ab.User.prototype.getUserId ab.User.prototype.setFirstName ab.User.prototype.setLastName ab.User.prototype.setEmail ab.User.prototype.setGender ab.User.prototype.setDateOfBirth ab.User.prototype.setCountry ab.User.prototype.setHomeCity ab.User.prototype.setLanguage ab.User.prototype.setEmailNotificationSubscriptionType ab.User.prototype.setPushNotificationSubscriptionType ab.User.prototype.setPhoneNumber ab.User.prototype.setAvatarImageUrl ab.User.prototype.setLastKnownLocation ab.User.prototype.setUserAttribute ab.User.prototype.setCustomUserAttribute ab.User.prototype.addToCustomAttributeArray ab.User.prototype.removeFromCustomAttributeArray ab.User.prototype.incrementCustomUserAttribute ab.User.prototype.addAlias ab.User.prototype.setCustomLocationAttribute ab.InAppMessage ab.InAppMessage.SlideFrom ab.InAppMessage.ClickAction ab.InAppMessage.DismissType ab.InAppMessage.OpenTarget ab.InAppMessage.ImageStyle ab.InAppMessage.TextAlignment ab.InAppMessage.Orientation ab.InAppMessage.CropType ab.InAppMessage.prototype.subscribeToClickedEvent ab.InAppMessage.prototype.subscribeToDismissedEvent ab.InAppMessage.prototype.removeSubscription ab.InAppMessage.prototype.removeAllSubscriptions ab.InAppMessage.prototype.closeMessage ab.InAppMessage.Button ab.InAppMessage.Button.prototype.subscribeToClickedEvent ab.InAppMessage.Button.prototype.removeSubscription ab.InAppMessage.Button.prototype.removeAllSubscriptions ab.SlideUpMessage ab.ModalMessage ab.FullScreenMessage ab.HtmlMessage ab.ControlMessage ab.Feed ab.Feed.prototype.getUnreadCardCount ab.ContentCards ab.ContentCards.prototype.getUnviewedCardCount ab.Card ab.Card.prototype.dismissCard ab.ClassicCard ab.CaptionedImage ab.Banner ab.ControlCard ab.WindowUtils display display.automaticallyShowNewInAppMessages display.showInAppMessage display.showFeed display.destroyFeed display.toggleFeed display.showContentCards display.hideContentCards display.toggleContentCards sharedLib".split(" "),s=0;s<o.length;s++){for(var a=o[s],u=e.appboy,c=a.split("."),l=0;l<c.length-1;l++)u=u[c[l]];u[c[l]]=new Function("return function "+a.replace(/\./g,"_")+"(){window.appboyQueue.push(arguments); return true}")()}window.appboy.getUser=function(){return new window.appboy.ab.User},window.appboy.getCachedFeed=function(){return new window.appboy.ab.Feed},window.appboy.getCachedContentCards=function(){return new window.appboy.ab.ContentCards},(i=t.createElement(n)).type="text/javascript",i.src="https://js.appboycdn.com/web-sdk/2.4/appboy.min.js",i.async=1,(r=t.getElementsByTagName(n)[0]).parentNode.insertBefore(i,r)}(window,document,"script"),window.appboy.initialize(this.appKey,{enableLogging:!0,baseUrl:this.endPoint}),window.appboy.display.automaticallyShowNewInAppMessages();var e=this.analytics.userId;e&&appboy.changeUser(e),window.appboy.openSession()}},{key:"handleReservedProperties",value:function(e){return["time","product_id","quantity","event_name","price","currency"].forEach((function(t){delete e[t]})),e}},{key:"identify",value:function(e){var t=e.message.userId,n=e.message.context.traits.address,r=e.message.context.traits.avatar,i=e.message.context.traits.birthday,o=e.message.context.traits.email,s=e.message.context.traits.firstname,a=e.message.context.traits.gender,u=e.message.context.traits.lastname,c=e.message.context.traits.phone,l=JSON.parse(JSON.stringify(e.message.context.traits));window.appboy.changeUser(t),window.appboy.getUser().setAvatarImageUrl(r),o&&window.appboy.getUser().setEmail(o),s&&window.appboy.getUser().setFirstName(s),a&&window.appboy.getUser().setGender(this.formatGender(a)),u&&window.appboy.getUser().setLastName(u),c&&window.appboy.getUser().setPhoneNumber(c),n&&(window.appboy.getUser().setCountry(n.country),window.appboy.getUser().setHomeCity(n.city)),i&&window.appboy.getUser().setDateOfBirth(i.getUTCFullYear(),i.getUTCMonth()+1,i.getUTCDate());["avatar","address","birthday","email","id","firstname","gender","lastname","phone","facebook","twitter","first_name","last_name","dob","external_id","country","home_city","bio","gender","phone","email_subscribe","push_subscribe"].forEach((function(e){delete l[e]})),Object.keys(l).forEach((function(e){window.appboy.getUser().setCustomUserAttribute(e,l[e])}))}},{key:"handlePurchase",value:function(e,t){var n=e.products,r=e.currency;window.appboy.changeUser(t),del(e,"products"),del(e,"currency"),n.forEach((function(t){var n=t.product_id,i=t.price,o=t.quantity;o&&i&&n&&window.appboy.logPurchase(n,i,r,o,e)}))}},{key:"track",value:function(e){var t=e.message.userId,n=e.message.event,r=e.message.properties;window.appboy.changeUser(t),"order completed"===n.toLowerCase()?this.handlePurchase(r,t):(r=this.handleReservedProperties(r),window.appboy.logCustomEvent(n,r))}},{key:"page",value:function(e){var t=e.message.userId,n=e.message.name,r=e.message.properties;r=this.handleReservedProperties(r),window.appboy.changeUser(t),window.appboy.logCustomEvent(n,r)}},{key:"isLoaded",value:function(){return null===window.appboyQueue}},{key:"isReady",value:function(){return null===window.appboyQueue}}]),e}(),x="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function R(e,t){return e(t={exports:{}},t.exports),t.exports}var P=R((function(e){!function(){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n={rotl:function(e,t){return e<<t|e>>>32-t},rotr:function(e,t){return e<<32-t|e>>>t},endian:function(e){if(e.constructor==Number)return 16711935&n.rotl(e,8)|4278255360&n.rotl(e,24);for(var t=0;t<e.length;t++)e[t]=n.endian(e[t]);return e},randomBytes:function(e){for(var t=[];e>0;e--)t.push(Math.floor(256*Math.random()));return t},bytesToWords:function(e){for(var t=[],n=0,r=0;n<e.length;n++,r+=8)t[r>>>5]|=e[n]<<24-r%32;return t},wordsToBytes:function(e){for(var t=[],n=0;n<32*e.length;n+=8)t.push(e[n>>>5]>>>24-n%32&255);return t},bytesToHex:function(e){for(var t=[],n=0;n<e.length;n++)t.push((e[n]>>>4).toString(16)),t.push((15&e[n]).toString(16));return t.join("")},hexToBytes:function(e){for(var t=[],n=0;n<e.length;n+=2)t.push(parseInt(e.substr(n,2),16));return t},bytesToBase64:function(e){for(var n=[],r=0;r<e.length;r+=3)for(var i=e[r]<<16|e[r+1]<<8|e[r+2],o=0;o<4;o++)8*r+6*o<=8*e.length?n.push(t.charAt(i>>>6*(3-o)&63)):n.push("=");return n.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/gi,"");for(var n=[],r=0,i=0;r<e.length;i=++r%4)0!=i&&n.push((t.indexOf(e.charAt(r-1))&Math.pow(2,-2*i+8)-1)<<2*i|t.indexOf(e.charAt(r))>>>6-2*i);return n}};e.exports=n}()})),U={utf8:{stringToBytes:function(e){return U.bin.stringToBytes(unescape(encodeURIComponent(e)))},bytesToString:function(e){return decodeURIComponent(escape(U.bin.bytesToString(e)))}},bin:{stringToBytes:function(e){for(var t=[],n=0;n<e.length;n++)t.push(255&e.charCodeAt(n));return t},bytesToString:function(e){for(var t=[],n=0;n<e.length;n++)t.push(String.fromCharCode(e[n]));return t.join("")}}},D=U,N=function(e){return null!=e&&(L(e)||function(e){return"function"==typeof e.readFloatLE&&"function"==typeof e.slice&&L(e.slice(0,0))}(e)||!!e._isBuffer)};function L(e){return!!e.constructor&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)}var M,B,F=R((function(e){!function(){var t=P,n=D.utf8,r=N,i=D.bin,o=function(e,s){e.constructor==String?e=s&&"binary"===s.encoding?i.stringToBytes(e):n.stringToBytes(e):r(e)?e=Array.prototype.slice.call(e,0):Array.isArray(e)||(e=e.toString());for(var a=t.bytesToWords(e),u=8*e.length,c=1732584193,l=-271733879,d=-1732584194,f=271733878,p=0;p<a.length;p++)a[p]=16711935&(a[p]<<8|a[p]>>>24)|4278255360&(a[p]<<24|a[p]>>>8);a[u>>>5]|=128<<u%32,a[14+(u+64>>>9<<4)]=u;var h=o._ff,g=o._gg,y=o._hh,m=o._ii;for(p=0;p<a.length;p+=16){var v=c,b=l,w=d,k=f;c=h(c,l,d,f,a[p+0],7,-680876936),f=h(f,c,l,d,a[p+1],12,-389564586),d=h(d,f,c,l,a[p+2],17,606105819),l=h(l,d,f,c,a[p+3],22,-1044525330),c=h(c,l,d,f,a[p+4],7,-176418897),f=h(f,c,l,d,a[p+5],12,1200080426),d=h(d,f,c,l,a[p+6],17,-1473231341),l=h(l,d,f,c,a[p+7],22,-45705983),c=h(c,l,d,f,a[p+8],7,1770035416),f=h(f,c,l,d,a[p+9],12,-1958414417),d=h(d,f,c,l,a[p+10],17,-42063),l=h(l,d,f,c,a[p+11],22,-1990404162),c=h(c,l,d,f,a[p+12],7,1804603682),f=h(f,c,l,d,a[p+13],12,-40341101),d=h(d,f,c,l,a[p+14],17,-1502002290),c=g(c,l=h(l,d,f,c,a[p+15],22,1236535329),d,f,a[p+1],5,-165796510),f=g(f,c,l,d,a[p+6],9,-1069501632),d=g(d,f,c,l,a[p+11],14,643717713),l=g(l,d,f,c,a[p+0],20,-373897302),c=g(c,l,d,f,a[p+5],5,-701558691),f=g(f,c,l,d,a[p+10],9,38016083),d=g(d,f,c,l,a[p+15],14,-660478335),l=g(l,d,f,c,a[p+4],20,-405537848),c=g(c,l,d,f,a[p+9],5,568446438),f=g(f,c,l,d,a[p+14],9,-1019803690),d=g(d,f,c,l,a[p+3],14,-187363961),l=g(l,d,f,c,a[p+8],20,1163531501),c=g(c,l,d,f,a[p+13],5,-1444681467),f=g(f,c,l,d,a[p+2],9,-51403784),d=g(d,f,c,l,a[p+7],14,1735328473),c=y(c,l=g(l,d,f,c,a[p+12],20,-1926607734),d,f,a[p+5],4,-378558),f=y(f,c,l,d,a[p+8],11,-2022574463),d=y(d,f,c,l,a[p+11],16,1839030562),l=y(l,d,f,c,a[p+14],23,-35309556),c=y(c,l,d,f,a[p+1],4,-1530992060),f=y(f,c,l,d,a[p+4],11,1272893353),d=y(d,f,c,l,a[p+7],16,-155497632),l=y(l,d,f,c,a[p+10],23,-1094730640),c=y(c,l,d,f,a[p+13],4,681279174),f=y(f,c,l,d,a[p+0],11,-358537222),d=y(d,f,c,l,a[p+3],16,-722521979),l=y(l,d,f,c,a[p+6],23,76029189),c=y(c,l,d,f,a[p+9],4,-640364487),f=y(f,c,l,d,a[p+12],11,-421815835),d=y(d,f,c,l,a[p+15],16,530742520),c=m(c,l=y(l,d,f,c,a[p+2],23,-995338651),d,f,a[p+0],6,-198630844),f=m(f,c,l,d,a[p+7],10,1126891415),d=m(d,f,c,l,a[p+14],15,-1416354905),l=m(l,d,f,c,a[p+5],21,-57434055),c=m(c,l,d,f,a[p+12],6,1700485571),f=m(f,c,l,d,a[p+3],10,-1894986606),d=m(d,f,c,l,a[p+10],15,-1051523),l=m(l,d,f,c,a[p+1],21,-2054922799),c=m(c,l,d,f,a[p+8],6,1873313359),f=m(f,c,l,d,a[p+15],10,-30611744),d=m(d,f,c,l,a[p+6],15,-1560198380),l=m(l,d,f,c,a[p+13],21,1309151649),c=m(c,l,d,f,a[p+4],6,-145523070),f=m(f,c,l,d,a[p+11],10,-1120210379),d=m(d,f,c,l,a[p+2],15,718787259),l=m(l,d,f,c,a[p+9],21,-343485551),c=c+v>>>0,l=l+b>>>0,d=d+w>>>0,f=f+k>>>0}return t.endian([c,l,d,f])};o._ff=function(e,t,n,r,i,o,s){var a=e+(t&n|~t&r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._gg=function(e,t,n,r,i,o,s){var a=e+(t&r|n&~r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._hh=function(e,t,n,r,i,o,s){var a=e+(t^n^r)+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._ii=function(e,t,n,r,i,o,s){var a=e+(n^(t|~r))+(i>>>0)+s;return(a<<o|a>>>32-o)+t},o._blocksize=16,o._digestsize=16,e.exports=function(e,n){if(null==e)throw new Error("Illegal argument "+e);var r=t.wordsToBytes(o(e,n));return n&&n.asBytes?r:n&&n.asString?i.bytesToString(r):t.bytesToHex(r)}}()})),K=function(){function e(t){n(this,e),this.NAME="INTERCOM",this.API_KEY=t.apiKey,this.APP_ID=t.appId,this.MOBILE_APP_ID=t.mobileAppId,f("Config ",t)}return i(e,[{key:"init",value:function(){window.intercomSettings={app_id:this.APP_ID},function(){var e=window,t=e.Intercom;if("function"==typeof t)t("reattach_activator"),t("update",e.intercomSettings);else{var n=document,r=function e(){e.c(arguments)};r.q=[],r.c=function(e){r.q.push(e)},e.Intercom=r;var i=function(){var e=n.createElement("script");e.type="text/javascript",e.async=!0,e.src="https://widget.intercom.io/widget/"+window.intercomSettings.app_id;var t=n.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)};"complete"===document.readyState?(i(),window.intercom_code=!0):e.attachEvent?(e.attachEvent("onload",i),window.intercom_code=!0):(e.addEventListener("load",i,!1),window.intercom_code=!0)}}()}},{key:"page",value:function(){window.Intercom("update")}},{key:"identify",value:function(e){var n={},r=e.message.context;if(null!=(r.Intercom?r.Intercom:null)){var i=r.Intercom.user_hash?r.Intercom.user_hash:null;null!=i&&(n.user_hash=i);var o=r.Intercom.hideDefaultLauncher?r.Intercom.hideDefaultLauncher:null;null!=o&&(n.hide_default_launcher=o)}Object.keys(r.traits).forEach((function(e){if(r.traits.hasOwnProperty(e)){var i=r.traits[e];if("company"===e){var o=[],s={};"string"==typeof r.traits[e]&&(s.company_id=F(r.traits[e]));var a="object"==t(r.traits[e])&&Object.keys(r.traits[e])||[];a.forEach((function(t){a.hasOwnProperty(t)&&("id"!=t?s[t]=r.traits[e][t]:s.company_id=r.traits[e][t])})),"object"!=t(r.traits[e])||a.includes("id")||(s.company_id=F(s.name)),o.push(s),n.companies=o}else n[e]=r.traits[e];switch(e){case"createdAt":n.created_at=i;break;case"anonymousId":n.user_id=i}}})),n.user_id=e.message.userId,window.Intercom("update",n)}},{key:"track",value:function(e){var t={},n=e.message;(n.properties?Object.keys(n.properties):null).forEach((function(e){var r=n.properties[e];t[e]=r})),n.event&&(t.event_name=n.event),t.user_id=n.userId?n.userId:n.anonymousId,t.created_at=Math.floor(new Date(n.originalTimestamp).getTime()/1e3),window.Intercom("trackEvent",t.event_name,t)}},{key:"isLoaded",value:function(){return!!window.intercom_code}},{key:"isReady",value:function(){return!!window.intercom_code}}]),e}(),q=function(){function e(t){n(this,e),this.projectID=t.projectID,this.writeKey=t.writeKey,this.ipAddon=t.ipAddon,this.uaAddon=t.uaAddon,this.urlAddon=t.urlAddon,this.referrerAddon=t.referrerAddon,this.client=null,this.name="KEEN"}return i(e,[{key:"init",value:function(){f("===in init Keen==="),I("keen-integration","https://cdn.jsdelivr.net/npm/keen-tracking@4");var e=setInterval(function(){void 0!==window.KeenTracking&&void 0!==window.KeenTracking&&(this.client=function(e){return e.client=new window.KeenTracking({projectId:e.projectID,writeKey:e.writeKey}),e.client}(this),clearInterval(e))}.bind(this),1e3)}},{key:"identify",value:function(e){f("in Keen identify");var t=e.message.context.traits,n=e.message.userId?e.message.userId:e.message.anonymousId,r=e.message.properties?Object.assign(r,e.message.properties):{};r.user={userId:n,traits:t},r=this.getAddOn(r),this.client.extendEvents(r)}},{key:"track",value:function(e){f("in Keen track");var t=e.message.event,n=e.message.properties;n=this.getAddOn(n),this.client.recordEvent(t,n)}},{key:"page",value:function(e){f("in Keen page");var t=e.message.name,n=e.message.properties?e.message.properties.category:void 0,r="Loaded a Page";t&&(r="Viewed "+t+" page"),n&&t&&(r="Viewed "+n+" "+t+" page");var i=e.message.properties;i=this.getAddOn(i),this.client.recordEvent(r,i)}},{key:"isLoaded",value:function(){return f("in Keen isLoaded"),!(null==this.client)}},{key:"isReady",value:function(){return!(null==this.client)}},{key:"getAddOn",value:function(e){var t=[];return this.ipAddon&&(e.ip_address="${keen.ip}",t.push({name:"keen:ip_to_geo",input:{ip:"ip_address"},output:"ip_geo_info"})),this.uaAddon&&(e.user_agent="${keen.user_agent}",t.push({name:"keen:ua_parser",input:{ua_string:"user_agent"},output:"parsed_user_agent"})),this.urlAddon&&(e.page_url=document.location.href,t.push({name:"keen:url_parser",input:{url:"page_url"},output:"parsed_page_url"})),this.referrerAddon&&(e.page_url=document.location.href,e.referrer_url=document.referrer,t.push({name:"keen:referrer_parser",input:{referrer_url:"referrer_url",page_url:"page_url"},output:"referrer_info"})),e.keen={addons:t},e}}]),e}(),G=Object.prototype,H=G.hasOwnProperty,V=G.toString;"function"==typeof Symbol&&(M=Symbol.prototype.valueOf),"function"==typeof BigInt&&(B=BigInt.prototype.valueOf);var z=function(e){return e!=e},J={boolean:1,number:1,string:1,undefined:1},W=/^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$/,$=/^[A-Fa-f0-9]+$/,Y={};Y.a=Y.type=function(e,t){return typeof e===t},Y.defined=function(e){return void 0!==e},Y.empty=function(e){var t,n=V.call(e);if("[object Array]"===n||"[object Arguments]"===n||"[object String]"===n)return 0===e.length;if("[object Object]"===n){for(t in e)if(H.call(e,t))return!1;return!0}return!e},Y.equal=function(e,t){if(e===t)return!0;var n,r=V.call(e);if(r!==V.call(t))return!1;if("[object Object]"===r){for(n in e)if(!Y.equal(e[n],t[n])||!(n in t))return!1;for(n in t)if(!Y.equal(e[n],t[n])||!(n in e))return!1;return!0}if("[object Array]"===r){if((n=e.length)!==t.length)return!1;for(;n--;)if(!Y.equal(e[n],t[n]))return!1;return!0}return"[object Function]"===r?e.prototype===t.prototype:"[object Date]"===r&&e.getTime()===t.getTime()},Y.hosted=function(e,t){var n=typeof t[e];return"object"===n?!!t[e]:!J[n]},Y.instance=Y.instanceof=function(e,t){return e instanceof t},Y.nil=Y.null=function(e){return null===e},Y.undef=Y.undefined=function(e){return void 0===e},Y.args=Y.arguments=function(e){var t="[object Arguments]"===V.call(e),n=!Y.array(e)&&Y.arraylike(e)&&Y.object(e)&&Y.fn(e.callee);return t||n},Y.array=Array.isArray||function(e){return"[object Array]"===V.call(e)},Y.args.empty=function(e){return Y.args(e)&&0===e.length},Y.array.empty=function(e){return Y.array(e)&&0===e.length},Y.arraylike=function(e){return!!e&&!Y.bool(e)&&H.call(e,"length")&&isFinite(e.length)&&Y.number(e.length)&&e.length>=0},Y.bool=Y.boolean=function(e){return"[object Boolean]"===V.call(e)},Y.false=function(e){return Y.bool(e)&&!1===Boolean(Number(e))},Y.true=function(e){return Y.bool(e)&&!0===Boolean(Number(e))},Y.date=function(e){return"[object Date]"===V.call(e)},Y.date.valid=function(e){return Y.date(e)&&!isNaN(Number(e))},Y.element=function(e){return void 0!==e&&"undefined"!=typeof HTMLElement&&e instanceof HTMLElement&&1===e.nodeType},Y.error=function(e){return"[object Error]"===V.call(e)},Y.fn=Y.function=function(e){if("undefined"!=typeof window&&e===window.alert)return!0;var t=V.call(e);return"[object Function]"===t||"[object GeneratorFunction]"===t||"[object AsyncFunction]"===t},Y.number=function(e){return"[object Number]"===V.call(e)},Y.infinite=function(e){return e===1/0||e===-1/0},Y.decimal=function(e){return Y.number(e)&&!z(e)&&!Y.infinite(e)&&e%1!=0},Y.divisibleBy=function(e,t){var n=Y.infinite(e),r=Y.infinite(t),i=Y.number(e)&&!z(e)&&Y.number(t)&&!z(t)&&0!==t;return n||r||i&&e%t==0},Y.integer=Y.int=function(e){return Y.number(e)&&!z(e)&&e%1==0},Y.maximum=function(e,t){if(z(e))throw new TypeError("NaN is not a valid value");if(!Y.arraylike(t))throw new TypeError("second argument must be array-like");for(var n=t.length;--n>=0;)if(e<t[n])return!1;return!0},Y.minimum=function(e,t){if(z(e))throw new TypeError("NaN is not a valid value");if(!Y.arraylike(t))throw new TypeError("second argument must be array-like");for(var n=t.length;--n>=0;)if(e>t[n])return!1;return!0},Y.nan=function(e){return!Y.number(e)||e!=e},Y.even=function(e){return Y.infinite(e)||Y.number(e)&&e==e&&e%2==0},Y.odd=function(e){return Y.infinite(e)||Y.number(e)&&e==e&&e%2!=0},Y.ge=function(e,t){if(z(e)||z(t))throw new TypeError("NaN is not a valid value");return!Y.infinite(e)&&!Y.infinite(t)&&e>=t},Y.gt=function(e,t){if(z(e)||z(t))throw new TypeError("NaN is not a valid value");return!Y.infinite(e)&&!Y.infinite(t)&&e>t},Y.le=function(e,t){if(z(e)||z(t))throw new TypeError("NaN is not a valid value");return!Y.infinite(e)&&!Y.infinite(t)&&e<=t},Y.lt=function(e,t){if(z(e)||z(t))throw new TypeError("NaN is not a valid value");return!Y.infinite(e)&&!Y.infinite(t)&&e<t},Y.within=function(e,t,n){if(z(e)||z(t)||z(n))throw new TypeError("NaN is not a valid value");if(!Y.number(e)||!Y.number(t)||!Y.number(n))throw new TypeError("all arguments must be numbers");return Y.infinite(e)||Y.infinite(t)||Y.infinite(n)||e>=t&&e<=n},Y.object=function(e){return"[object Object]"===V.call(e)},Y.primitive=function(e){return!e||!("object"==typeof e||Y.object(e)||Y.fn(e)||Y.array(e))},Y.hash=function(e){return Y.object(e)&&e.constructor===Object&&!e.nodeType&&!e.setInterval},Y.regexp=function(e){return"[object RegExp]"===V.call(e)},Y.string=function(e){return"[object String]"===V.call(e)},Y.base64=function(e){return Y.string(e)&&(!e.length||W.test(e))},Y.hex=function(e){return Y.string(e)&&(!e.length||$.test(e))},Y.symbol=function(e){return"function"==typeof Symbol&&"[object Symbol]"===V.call(e)&&"symbol"==typeof M.call(e)},Y.bigint=function(e){return"function"==typeof BigInt&&"[object BigInt]"===V.call(e)&&"bigint"==typeof B.call(e)};var Q,Z=Y,X=Object.prototype.hasOwnProperty,ee=function(e){for(var t=Array.prototype.slice.call(arguments,1),n=0;n<t.length;n+=1)for(var r in t[n])X.call(t[n],r)&&(e[r]=t[n][r]);return e},te=R((function(e){function t(e){return function(t,n,r,o){var s;normalize=o&&function(e){return"function"==typeof e}(o.normalizer)?o.normalizer:i,n=normalize(n);for(var a=!1;!a;)u();function u(){for(s in t){var e=normalize(s);if(0===n.indexOf(e)){var r=n.substr(e.length);if("."===r.charAt(0)||0===r.length){n=r.substr(1);var i=t[s];return null==i?void(a=!0):n.length?void(t=i):void(a=!0)}}}s=void 0,a=!0}if(s)return null==t?t:e(t,s,r)}}function n(e,t){return e.hasOwnProperty(t)&&delete e[t],e}function r(e,t,n){return e.hasOwnProperty(t)&&(e[t]=n),e}function i(e){return e.replace(/[^a-zA-Z0-9\.]+/g,"").toLowerCase()}e.exports=t((function(e,t){if(e.hasOwnProperty(t))return e[t]})),e.exports.find=e.exports,e.exports.replace=function(e,n,i,o){return t(r).call(this,e,n,i,o),e},e.exports.del=function(e,r,i){return t(n).call(this,e,r,null,i),e}})),ne=(te.find,te.replace,te.del,Object.prototype.toString),re=function(e){switch(ne.call(e)){case"[object Function]":return"function";case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object String]":return"string"}return null===e?"null":void 0===e?"undefined":e&&1===e.nodeType?"element":e===Object(e)?"object":typeof e},ie=/\b(Array|Date|Object|Math|JSON)\b/g,oe=function(e,t){var n=function(e){for(var t=[],n=0;n<e.length;n++)~t.indexOf(e[n])||t.push(e[n]);return t}(function(e){return e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\//g,"").replace(ie,"").match(/[a-zA-Z_]\w*/g)||[]}(e));return t&&"string"==typeof t&&(t=function(e){return function(t){return e+t}}(t)),t?function(e,t,n){return e.replace(/\.\w+|\w+ *\(|"[^"]*"|'[^']*'|\/([^/]+)\/|[a-zA-Z_]\w*/g,(function(e){return"("==e[e.length-1]||~t.indexOf(e)?n(e):e}))}(e,n,t):n};try{Q=oe}catch(e){Q=oe}var se=ae;function ae(e){switch({}.toString.call(e)){case"[object Object]":return function(e){var t={};for(var n in e)t[n]="string"==typeof e[n]?ue(e[n]):ae(e[n]);return function(e){if("object"!=typeof e)return!1;for(var n in t){if(!(n in e))return!1;if(!t[n](e[n]))return!1}return!0}}(e);case"[object Function]":return e;case"[object String]":return/^ *\W+/.test(n=e)?new Function("_","return _ "+n):new Function("_","return "+function(e){var t,n,r,i=Q(e);if(!i.length)return"_."+e;for(n=0;n<i.length;n++)r=i[n],e=ce(r,e,t="('function' == typeof "+(t="_."+r)+" ? "+t+"() : "+t+")");return e}(n));case"[object RegExp]":return t=e,function(e){return t.test(e)};default:return ue(e)}var t,n}function ue(e){return function(t){return e===t}}function ce(e,t,n){return t.replace(new RegExp("(\\.)?"+e,"g"),(function(e,t){return t?e:n}))}try{var le=re}catch(e){le=re}var de=Object.prototype.hasOwnProperty,fe=function(e,t,n){switch(t=se(t),n=n||this,le(e)){case"array":return pe(e,t,n);case"object":return"number"==typeof e.length?pe(e,t,n):function(e,t,n){for(var r in e)de.call(e,r)&&t.call(n,r,e[r])}(e,t,n);case"string":return function(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e.charAt(r),r)}(e,t,n)}};function pe(e,t,n){for(var r=0;r<e.length;++r)t.call(n,e[r],r)}var he=function(){function e(t){n(this,e),this.apiKey=t.apiKey,this.prefixProperties=t.prefixProperties,this.name="KISSMETRICS"}return i(e,[{key:"init",value:function(){f("===in init Kissmetrics==="),window._kmq=window._kmq||[];var e=window._kmk||this.apiKey;function t(e){setTimeout((function(){var t=document,n=t.getElementsByTagName("script")[0],r=t.createElement("script");r.type="text/javascript",r.async=!0,r.src=e,n.parentNode.insertBefore(r,n)}),1)}t("//i.kissmetrics.com/i.js"),t("//scripts.kissmetrics.com/"+e+".2.js"),this.isEnvMobile()&&window._kmq.push(["set",{"Mobile Session":"Yes"}])}},{key:"isEnvMobile",value:function(){return navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/Opera Mini/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPhone|iPod/i)}},{key:"toUnixTimestamp",value:function(e){return e=new Date(e),Math.floor(e.getTime()/1e3)}},{key:"clean",value:function(e){var t={};for(var n in e)if(e.hasOwnProperty(n)){var r=e[n];if(null==r)continue;if(Z.date(r)){t[n]=this.toUnixTimestamp(r);continue}if(Z.bool(r)){t[n]=r;continue}if(Z.number(r)){t[n]=r;continue}if(f(r.toString()),"[object Object]"!==r.toString()){t[n]=r.toString();continue}var i={};i[n]=r;var o=this.flatten(i,{safe:!0});for(var s in o)Z.array(o[s])&&(o[s]=o[s].toString());delete(t=ee(t,o))[n]}return t}},{key:"flatten",value:function(e,t){var n=(t=t||{}).delimiter||".",r=t.maxDepth,i=1,o={};return function e(s,a){for(var u in s)if(s.hasOwnProperty(u)){var c=s[u],l=t.safe&&Z.array(c),d=Object.prototype.toString.call(c),f="[object Object]"===d||"[object Array]"===d,p=[],h=a?a+n+u:u;for(var g in t.maxDepth||(r=i+1),c)c.hasOwnProperty(g)&&p.push(g);if(!l&&f&&p.length&&i<r)return++i,e(c,h);o[h]=c}}(e),o}},{key:"prefix",value:function(e,t){var n={};return fe(t,(function(t,r){"Billing Amount"===t?n[t]=r:"revenue"===t?(n[e+" - "+t]=r,n["Billing Amount"]=r):n[e+" - "+t]=r})),n}},{key:"identify",value:function(e){f("in Kissmetrics identify");var t=this.clean(e.message.context.traits),n=e.message.userId&&""!=e.message.userId?e.message.userId:void 0;n&&window._kmq.push(["identify",n]),t&&window._kmq.push(["set",t])}},{key:"track",value:function(e){f("in Kissmetrics track");var t=e.message.event,n=JSON.parse(JSON.stringify(e.message.properties)),r=this.toUnixTimestamp(new Date),i=w(n);i&&(n.revenue=i);var o=n.products;o&&delete n.products,n=this.clean(n),f(JSON.stringify(n)),this.prefixProperties&&(n=this.prefix(t,n)),window._kmq.push(["record",t,n]);var s=function(e,n){var i=e;this.prefixProperties&&(i=this.prefix(t,i)),i._t=r+n,i._d=1,window.KM.set(i)}.bind(this);o&&window._kmq.push((function(){fe(o,s)}))}},{key:"page",value:function(e){f("in Kissmetrics page");var t=e.message.name,n=e.message.properties?e.message.properties.category:void 0,r="Loaded a Page";t&&(r="Viewed "+t+" page"),n&&t&&(r="Viewed "+n+" "+t+" page");var i=e.message.properties;this.prefixProperties&&(i=this.prefix("Page",i)),window._kmq.push(["record",r,i])}},{key:"alias",value:function(e){var t=e.message.previousId,n=e.message.userId;window._kmq.push(["alias",n,t])}},{key:"group",value:function(e){var t=e.message.groupId,n=e.message.traits;n=this.prefix("Group",n),t&&(n["Group - id"]=t),window._kmq.push(["set",n]),f("in Kissmetrics group")}},{key:"isLoaded",value:function(){return Z.object(window.KM)}},{key:"isReady",value:function(){return Z.object(window.KM)}}]),e}(),ge=function(){function e(t){n(this,e),this.siteID=t.siteID,this.apiKey=t.apiKey,this.name="CUSTOMERIO"}return i(e,[{key:"init",value:function(){f("===in init Customer IO init==="),window._cio=window._cio||[];var e=this.siteID;!function(){var t,n,r;for(t=function(e){return function(){window._cio.push([e].concat(Array.prototype.slice.call(arguments,0)))}},n=["load","identify","sidentify","track","page"],r=0;r<n.length;r++)window._cio[n[r]]=t(n[r]);var i=document.createElement("script"),o=document.getElementsByTagName("script")[0];i.async=!0,i.id="cio-tracker",i.setAttribute("data-site-id",e),i.src="https://assets.customer.io/assets/track.js",o.parentNode.insertBefore(i,o)}()}},{key:"identify",value:function(e){f("in Customer IO identify");var t=e.message.userId?e.message.userId:e.message.anonymousId,n=e.message.context.traits?e.message.context.traits:{};n.created_at||(n.created_at=Math.floor((new Date).getTime()/1e3)),n.id=t,window._cio.identify(n)}},{key:"track",value:function(e){f("in Customer IO track");var t=e.message.event,n=e.message.properties;window._cio.track(t,n)}},{key:"page",value:function(e){f("in Customer IO page");var t=e.message.name||e.message.properties.url;window._cio.page(t,e.message.properties)}},{key:"isLoaded",value:function(){return!(!window._cio||window._cio.push===Array.prototype.push)}},{key:"isReady",value:function(){return!(!window._cio||window._cio.push===Array.prototype.push)}}]),e}(),ye=!1,me=[],ve=setInterval((function(){document.body&&(ye=!0,fe(me,be),clearInterval(ve))}),5);function be(e){e(document.body)}var we=function(){function e(t,r){n(this,e),this.analytics=r,this._sf_async_config=window._sf_async_config=window._sf_async_config||{},window._sf_async_config.useCanonical=!0,window._sf_async_config.uid=t.uid,window._sf_async_config.domain=t.domain,this.isVideo=!!t.video,this.sendNameAndCategoryAsTitle=t.sendNameAndCategoryAsTitle||!0,this.subscriberEngagementKeys=t.subscriberEngagementKeys||[],this.replayEvents=[],this.failed=!1,this.isFirstPageCallMade=!1,this.name="Chartbeat"}return i(e,[{key:"init",value:function(){f("===in init Chartbeat===")}},{key:"identify",value:function(e){f("in Chartbeat identify")}},{key:"track",value:function(e){f("in Chartbeat track")}},{key:"page",value:function(e){if(f("in Chartbeat page"),this.loadConfig(e),this.isFirstPageCallMade){if(this.failed)return f("===ignoring cause failed integration==="),void(this.replayEvents=[]);if(!this.isLoaded()&&!this.failed)return f("===pushing to replay queue for chartbeat==="),void this.replayEvents.push(["page",e]);f("===processing page event in chartbeat===");var t=e.message.properties;window.pSUPERFLY.virtualPage(t.path)}else this.isFirstPageCallMade=!0,this.initAfterPage()}},{key:"isLoaded",value:function(){return f("in Chartbeat isLoaded"),!this.isFirstPageCallMade||!!window.pSUPERFLY}},{key:"isFailed",value:function(){return this.failed}},{key:"isReady",value:function(){return!!window.pSUPERFLY}},{key:"loadConfig",value:function(e){var t,n=e.message.properties,r=n?n.category:void 0,i=e.message.name,o=n?n.author:void 0;this.sendNameAndCategoryAsTitle&&(t=r&&i?r+" "+i:i),r&&(window._sf_async_config.sections=r),o&&(window._sf_async_config.authors=o),t&&(window._sf_async_config.title=t);var s=window._cbq=window._cbq||[];for(var a in n)n.hasOwnProperty(a)&&this.subscriberEngagementKeys.indexOf(a)>-1&&s.push([a,n[a]])}},{key:"initAfterPage",value:function(){var e,t=this;e=function(){var e,n,r=t.isVideo?"chartbeat_video.js":"chartbeat.js";e=document.createElement("script"),n=document.getElementsByTagName("script")[0],e.type="text/javascript",e.async=!0,e.src="//static.chartbeat.com/js/"+r,n.parentNode.insertBefore(e,n)},ye?be(e):me.push(e),this._isReady(this).then((function(e){f("===replaying on chartbeat==="),e.replayEvents.forEach((function(t){e[t[0]](t[1])}))}))}},{key:"pause",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:"_isReady",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){return t.isLoaded()?(t.failed=!1,f("===chartbeat loaded successfully==="),e.analytics.emit("ready"),r(e)):n>=1e4?(t.failed=!0,f("===chartbeat failed==="),r(e)):void t.pause(1e3).then((function(){return t._isReady(e,n+1e3).then(r)}))}))}}]),e}(),ke=function(){function e(t,r){n(this,e),this.c2ID=t.c2ID,this.analytics=r,this.comScoreBeaconParam=t.comScoreBeaconParam?t.comScoreBeaconParam:{},this.isFirstPageCallMade=!1,this.failed=!1,this.comScoreParams={},this.replayEvents=[],this.name="COMSCORE"}return i(e,[{key:"init",value:function(){f("===in init Comscore init===")}},{key:"identify",value:function(e){f("in Comscore identify")}},{key:"track",value:function(e){f("in Comscore track")}},{key:"page",value:function(e){if(f("in Comscore page"),this.loadConfig(e),this.isFirstPageCallMade){if(this.failed)return void(this.replayEvents=[]);if(!this.isLoaded()&&!this.failed)return void this.replayEvents.push(["page",e]);e.message.properties;window.COMSCORE.beacon(this.comScoreParams)}else this.isFirstPageCallMade=!0,this.initAfterPage()}},{key:"loadConfig",value:function(e){f("=====in loadConfig====="),this.comScoreParams=this.mapComscoreParams(e.message.properties),window._comscore=window._comscore||[],window._comscore.push(this.comScoreParams)}},{key:"initAfterPage",value:function(){f("=====in initAfterPage====="),function(){var e=document.createElement("script"),t=document.getElementsByTagName("script")[0];e.async=!0,e.src=("https:"==document.location.protocol?"https://sb":"http://b")+".scorecardresearch.com/beacon.js",t.parentNode.insertBefore(e,t)}(),this._isReady(this).then((function(e){e.replayEvents.forEach((function(t){e[t[0]](t[1])}))}))}},{key:"pause",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:"_isReady",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){return t.isLoaded()?(t.failed=!1,e.analytics.emit("ready"),r(e)):n>=1e4?(t.failed=!0,r(e)):void t.pause(1e3).then((function(){return t._isReady(e,n+1e3).then(r)}))}))}},{key:"mapComscoreParams",value:function(e){f("=====in mapComscoreParams=====");var t=this.comScoreBeaconParam,n={};return Object.keys(t).forEach((function(r){if(r in e){var i=t[r],o=e[r];n[i]=o}})),n.c1="2",n.c2=this.c2ID,f("=====in mapComscoreParams=====",n),n}},{key:"isLoaded",value:function(){return f("in Comscore isLoaded"),!this.isFirstPageCallMade||!!window.COMSCORE}},{key:"isReady",value:function(){return!!window.COMSCORE}}]),e}(),_e=Object.prototype.toString;var Ie=function e(t){var n=function(e){switch(_e.call(e)){case"[object Date]":return"date";case"[object RegExp]":return"regexp";case"[object Arguments]":return"arguments";case"[object Array]":return"array";case"[object Error]":return"error"}return null===e?"null":void 0===e?"undefined":e!=e?"nan":e&&1===e.nodeType?"element":null!=(t=e)&&(t._isBuffer||t.constructor&&"function"==typeof t.constructor.isBuffer&&t.constructor.isBuffer(t))?"buffer":typeof(e=e.valueOf?e.valueOf():Object.prototype.valueOf.apply(e));var t}(t);if("object"===n){var r={};for(var i in t)t.hasOwnProperty(i)&&(r[i]=e(t[i]));return r}if("array"===n){r=new Array(t.length);for(var o=0,s=t.length;o<s;o++)r[o]=e(t[o]);return r}if("regexp"===n){var a="";return a+=t.multiline?"m":"",a+=t.global?"g":"",a+=t.ignoreCase?"i":"",new RegExp(t.source,a)}return"date"===n?new Date(t.getTime()):t},Ee=1e3,Ae=6e4,Te=60*Ae,Ce=24*Te,Oe=function(e,t){return t=t||{},"string"==typeof e?function(e){if((e=""+e).length>1e4)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*Ce;case"hours":case"hour":case"hrs":case"hr":case"h":return n*Te;case"minutes":case"minute":case"mins":case"min":case"m":return n*Ae;case"seconds":case"second":case"secs":case"sec":case"s":return n*Ee;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}(e):t.long?function(e){return Se(e,Ce,"day")||Se(e,Te,"hour")||Se(e,Ae,"minute")||Se(e,Ee,"second")||e+" ms"}(e):function(e){return e>=Ce?Math.round(e/Ce)+"d":e>=Te?Math.round(e/Te)+"h":e>=Ae?Math.round(e/Ae)+"m":e>=Ee?Math.round(e/Ee)+"s":e+"ms"}(e)};function Se(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}var je=R((function(e,t){(t=e.exports=function(e){function r(){}function o(){var e=o,r=+new Date,s=r-(n||r);e.diff=s,e.prev=n,e.curr=r,n=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=i());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var u=0;a[0]=a[0].replace(/%([a-z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(e,o),a.splice(u,1),u--}return n})),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var c=o.log||t.log||console.log.bind(console);c.apply(e,a)}r.enabled=!1,o.enabled=!0;var s=t.enabled(e)?o:r;return s.namespace=e,s}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Oe,t.names=[],t.skips=[],t.formatters={};var n,r=0;function i(){return t.colors[r++%t.colors.length]}})),xe=(je.coerce,je.disable,je.enable,je.enabled,je.humanize,je.names,je.skips,je.formatters,R((function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return e}(t=e.exports=je).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r),e},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(n())}))),Re=(xe.log,xe.formatArgs,xe.save,xe.load,xe.useColors,xe.storage,xe.colors,xe("cookie")),Pe=function(e,t,n){switch(arguments.length){case 3:case 2:return Ue(e,t,n);case 1:return Ne(e);default:return De()}};function Ue(e,t,n){n=n||{};var r=Le(e)+"="+Le(t);null==t&&(n.maxage=-1),n.maxage&&(n.expires=new Date(+new Date+n.maxage)),n.path&&(r+="; path="+n.path),n.domain&&(r+="; domain="+n.domain),n.expires&&(r+="; expires="+n.expires.toUTCString()),n.samesite&&(r+="; samesite="+n.samesite),n.secure&&(r+="; secure"),document.cookie=r}function De(){var e;try{e=document.cookie}catch(e){return"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e.stack||e),{}}return function(e){var t,n={},r=e.split(/ *; */);if(""==r[0])return n;for(var i=0;i<r.length;++i)t=r[i].split("="),n[Me(t[0])]=Me(t[1]);return n}(e)}function Ne(e){return De()[e]}function Le(e){try{return encodeURIComponent(e)}catch(t){Re("error `encode(%o)` - %o",e,t)}}function Me(e){try{return decodeURIComponent(e)}catch(t){Re("error `decode(%o)` - %o",e,t)}}var Be=Math.max,Fe=function(e,t){var n=t?t.length:0;if(!n)return[];for(var r=Be(Number(e)||0,0),i=Be(n-r,0),o=new Array(i),s=0;s<i;s+=1)o[s]=t[s+r];return o},Ke=Math.max,qe=function(e){if(null==e||!e.length)return[];for(var t=new Array(Ke(e.length-2,0)),n=1;n<e.length;n+=1)t[n-1]=e[n];return t},Ge=Object.prototype.hasOwnProperty,He=Object.prototype.toString,Ve=function(e){return Boolean(e)&&"object"==typeof e},ze=function(e){return Boolean(e)&&"[object Object]"===He.call(e)},Je=function(e,t,n,r){return Ge.call(t,r)&&void 0===e[r]&&(e[r]=n),t},We=function(e,t,n,r){return Ge.call(t,r)&&(ze(e[r])&&ze(n)?e[r]=Ye(e[r],n):void 0===e[r]&&(e[r]=n)),t},$e=function(e,t){if(!Ve(t))return t;e=e||Je;for(var n=Fe(2,arguments),r=0;r<n.length;r+=1)for(var i in n[r])e(t,n[r],n[r][i],i);return t},Ye=function(e){return $e.apply(null,[We,e].concat(qe(arguments)))},Qe=function(e){return $e.apply(null,[null,e].concat(qe(arguments)))},Ze=Ye;Qe.deep=Ze;var Xe=R((function(e,t){(function(){var n={function:!0,object:!0},r=n.object&&t&&!t.nodeType&&t,i=n[typeof window]&&window||this,o=r&&n.object&&e&&!e.nodeType&&"object"==typeof x&&x;function s(e,t){e||(e=i.Object()),t||(t=i.Object());var r=e.Number||i.Number,o=e.String||i.String,a=e.Object||i.Object,u=e.Date||i.Date,c=e.SyntaxError||i.SyntaxError,l=e.TypeError||i.TypeError,d=e.Math||i.Math,f=e.JSON||i.JSON;"object"==typeof f&&f&&(t.stringify=f.stringify,t.parse=f.parse);var p=a.prototype,h=p.toString,g=p.hasOwnProperty;function y(e,t){try{e()}catch(e){t&&t()}}var m=new u(-0xc782b5b800cec);function v(e){if(null!=v[e])return v[e];var n;if("bug-string-char-index"==e)n="a"!="a"[0];else if("json"==e)n=v("json-stringify")&&v("date-serialization")&&v("json-parse");else if("date-serialization"==e){if(n=v("json-stringify")&&m){var i=t.stringify;y((function(){n='"-271821-04-20T00:00:00.000Z"'==i(new u(-864e13))&&'"+275760-09-13T00:00:00.000Z"'==i(new u(864e13))&&'"-000001-01-01T00:00:00.000Z"'==i(new u(-621987552e5))&&'"1969-12-31T23:59:59.999Z"'==i(new u(-1))}))}}else{var s,a='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}';if("json-stringify"==e){var c="function"==typeof(i=t.stringify);c&&((s=function(){return 1}).toJSON=s,y((function(){c="0"===i(0)&&"0"===i(new r)&&'""'==i(new o)&&void 0===i(h)&&void 0===i(void 0)&&void 0===i()&&"1"===i(s)&&"[1]"==i([s])&&"[null]"==i([void 0])&&"null"==i(null)&&"[null,null,null]"==i([void 0,h,null])&&i({a:[s,!0,!1,null,"\0\b\n\f\r\t"]})==a&&"1"===i(null,s)&&"[\n 1,\n 2\n]"==i([1,2],null,1)}),(function(){c=!1}))),n=c}if("json-parse"==e){var l,d=t.parse;"function"==typeof d&&y((function(){0!==d("0")||d(!1)||(s=d(a),(l=5==s.a.length&&1===s.a[0])&&(y((function(){l=!d('"\t"')})),l&&y((function(){l=1!==d("01")})),l&&y((function(){l=1!==d("1.")}))))}),(function(){l=!1})),n=l}}return v[e]=!!n}if(y((function(){m=-109252==m.getUTCFullYear()&&0===m.getUTCMonth()&&1===m.getUTCDate()&&10==m.getUTCHours()&&37==m.getUTCMinutes()&&6==m.getUTCSeconds()&&708==m.getUTCMilliseconds()})),v["bug-string-char-index"]=v["date-serialization"]=v.json=v["json-stringify"]=v["json-parse"]=null,!v("json")){var b=v("bug-string-char-index"),w=function(e,t){var r,i,o,s=0;for(o in(r=function(){this.valueOf=0}).prototype.valueOf=0,i=new r)g.call(i,o)&&s++;return r=i=null,s?w=function(e,t){var n,r,i="[object Function]"==h.call(e);for(n in e)i&&"prototype"==n||!g.call(e,n)||(r="constructor"===n)||t(n);(r||g.call(e,n="constructor"))&&t(n)}:(i=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],w=function(e,t){var r,o,s="[object Function]"==h.call(e),a=!s&&"function"!=typeof e.constructor&&n[typeof e.hasOwnProperty]&&e.hasOwnProperty||g;for(r in e)s&&"prototype"==r||!a.call(e,r)||t(r);for(o=i.length;r=i[--o];)a.call(e,r)&&t(r)}),w(e,t)};if(!v("json-stringify")&&!v("date-serialization")){var k={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},_=function(e,t){return("000000"+(t||0)).slice(-e)},I=function(e){var t,n,r,i,o,s,a,u,c;if(m)t=function(e){n=e.getUTCFullYear(),r=e.getUTCMonth(),i=e.getUTCDate(),s=e.getUTCHours(),a=e.getUTCMinutes(),u=e.getUTCSeconds(),c=e.getUTCMilliseconds()};else{var l=d.floor,f=[0,31,59,90,120,151,181,212,243,273,304,334],p=function(e,t){return f[t]+365*(e-1970)+l((e-1969+(t=+(t>1)))/4)-l((e-1901+t)/100)+l((e-1601+t)/400)};t=function(e){for(i=l(e/864e5),n=l(i/365.2425)+1970-1;p(n+1,0)<=i;n++);for(r=l((i-p(n,0))/30.42);p(n,r+1)<=i;r++);i=1+i-p(n,r),s=l((o=(e%864e5+864e5)%864e5)/36e5)%24,a=l(o/6e4)%60,u=l(o/1e3)%60,c=o%1e3}}return(I=function(e){return e>-1/0&&e<1/0?(t(e),e=(n<=0||n>=1e4?(n<0?"-":"+")+_(6,n<0?-n:n):_(4,n))+"-"+_(2,r+1)+"-"+_(2,i)+"T"+_(2,s)+":"+_(2,a)+":"+_(2,u)+"."+_(3,c)+"Z",n=r=i=s=a=u=c=null):e=null,e})(e)};if(v("json-stringify")&&!v("date-serialization")){function E(e){return I(this)}var A=t.stringify;t.stringify=function(e,t,n){var r=u.prototype.toJSON;u.prototype.toJSON=E;var i=A(e,t,n);return u.prototype.toJSON=r,i}}else{var T=function(e){var t=e.charCodeAt(0),n=k[t];return n||"\\u00"+_(2,t.toString(16))},C=/[\x00-\x1f\x22\x5c]/g,O=function(e){return C.lastIndex=0,'"'+(C.test(e)?e.replace(C,T):e)+'"'},S=function(e,t,n,r,i,o,s){var a,c,d,f,p,g,m,v,b;if(y((function(){a=t[e]})),"object"==typeof a&&a&&(a.getUTCFullYear&&"[object Date]"==h.call(a)&&a.toJSON===u.prototype.toJSON?a=I(a):"function"==typeof a.toJSON&&(a=a.toJSON(e))),n&&(a=n.call(t,e,a)),null==a)return void 0===a?a:"null";switch("object"==(c=typeof a)&&(d=h.call(a)),d||c){case"boolean":case"[object Boolean]":return""+a;case"number":case"[object Number]":return a>-1/0&&a<1/0?""+a:"null";case"string":case"[object String]":return O(""+a)}if("object"==typeof a){for(m=s.length;m--;)if(s[m]===a)throw l();if(s.push(a),f=[],v=o,o+=i,"[object Array]"==d){for(g=0,m=a.length;g<m;g++)p=S(g,a,n,r,i,o,s),f.push(void 0===p?"null":p);b=f.length?i?"[\n"+o+f.join(",\n"+o)+"\n"+v+"]":"["+f.join(",")+"]":"[]"}else w(r||a,(function(e){var t=S(e,a,n,r,i,o,s);void 0!==t&&f.push(O(e)+":"+(i?" ":"")+t)})),b=f.length?i?"{\n"+o+f.join(",\n"+o)+"\n"+v+"}":"{"+f.join(",")+"}":"{}";return s.pop(),b}};t.stringify=function(e,t,r){var i,o,s,a;if(n[typeof t]&&t)if("[object Function]"==(a=h.call(t)))o=t;else if("[object Array]"==a){s={};for(var u,c=0,l=t.length;c<l;)u=t[c++],"[object String]"!=(a=h.call(u))&&"[object Number]"!=a||(s[u]=1)}if(r)if("[object Number]"==(a=h.call(r))){if((r-=r%1)>0)for(r>10&&(r=10),i="";i.length<r;)i+=" "}else"[object String]"==a&&(i=r.length<=10?r:r.slice(0,10));return S("",((u={})[""]=e,u),o,s,i,"",[])}}}if(!v("json-parse")){var j,x,R=o.fromCharCode,P={92:"\\",34:'"',47:"/",98:"\b",116:"\t",110:"\n",102:"\f",114:"\r"},U=function(){throw j=x=null,c()},D=function(){for(var e,t,n,r,i,o=x,s=o.length;j<s;)switch(i=o.charCodeAt(j)){case 9:case 10:case 13:case 32:j++;break;case 123:case 125:case 91:case 93:case 58:case 44:return e=b?o.charAt(j):o[j],j++,e;case 34:for(e="@",j++;j<s;)if((i=o.charCodeAt(j))<32)U();else if(92==i)switch(i=o.charCodeAt(++j)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:e+=P[i],j++;break;case 117:for(t=++j,n=j+4;j<n;j++)(i=o.charCodeAt(j))>=48&&i<=57||i>=97&&i<=102||i>=65&&i<=70||U();e+=R("0x"+o.slice(t,j));break;default:U()}else{if(34==i)break;for(i=o.charCodeAt(j),t=j;i>=32&&92!=i&&34!=i;)i=o.charCodeAt(++j);e+=o.slice(t,j)}if(34==o.charCodeAt(j))return j++,e;U();default:if(t=j,45==i&&(r=!0,i=o.charCodeAt(++j)),i>=48&&i<=57){for(48==i&&((i=o.charCodeAt(j+1))>=48&&i<=57)&&U(),r=!1;j<s&&((i=o.charCodeAt(j))>=48&&i<=57);j++);if(46==o.charCodeAt(j)){for(n=++j;n<s&&!((i=o.charCodeAt(n))<48||i>57);n++);n==j&&U(),j=n}if(101==(i=o.charCodeAt(j))||69==i){for(43!=(i=o.charCodeAt(++j))&&45!=i||j++,n=j;n<s&&!((i=o.charCodeAt(n))<48||i>57);n++);n==j&&U(),j=n}return+o.slice(t,j)}r&&U();var a=o.slice(j,j+4);if("true"==a)return j+=4,!0;if("fals"==a&&101==o.charCodeAt(j+4))return j+=5,!1;if("null"==a)return j+=4,null;U()}return"$"},N=function(e){var t,n;if("$"==e&&U(),"string"==typeof e){if("@"==(b?e.charAt(0):e[0]))return e.slice(1);if("["==e){for(t=[];"]"!=(e=D());)n?","==e?"]"==(e=D())&&U():U():n=!0,","==e&&U(),t.push(N(e));return t}if("{"==e){for(t={};"}"!=(e=D());)n?","==e?"}"==(e=D())&&U():U():n=!0,","!=e&&"string"==typeof e&&"@"==(b?e.charAt(0):e[0])&&":"==D()||U(),t[e.slice(1)]=N(D());return t}U()}return e},L=function(e,t,n){var r=M(e,t,n);void 0===r?delete e[t]:e[t]=r},M=function(e,t,n){var r,i=e[t];if("object"==typeof i&&i)if("[object Array]"==h.call(i))for(r=i.length;r--;)L(h,w,i);else w(i,(function(e){L(i,e,n)}));return n.call(e,t,i)};t.parse=function(e,t){var n,r;return j=0,x=""+e,n=N(D()),"$"!=D()&&U(),j=x=null,t&&"[object Function]"==h.call(t)?M(((r={})[""]=n,r),"",t):n}}}return t.runInContext=s,t}if(!o||o.global!==o&&o.window!==o&&o.self!==o||(i=o),r)s(i,r);else{var a=i.JSON,u=i.JSON3,c=!1,l=s(i,i.JSON3={noConflict:function(){return c||(c=!0,i.JSON=a,i.JSON3=u,a=u=null),l}});i.JSON={parse:l.parse,stringify:l.stringify}}}).call(x)})),et=R((function(e,t){function n(e){switch(e){case"http:":return 80;case"https:":return 443;default:return location.port}}t.parse=function(e){var t=document.createElement("a");return t.href=e,{href:t.href,host:t.host||location.host,port:"0"===t.port||""===t.port?n(t.protocol):t.port,hash:t.hash,hostname:t.hostname||location.hostname,pathname:"/"!=t.pathname.charAt(0)?"/"+t.pathname:t.pathname,protocol:t.protocol&&":"!=t.protocol?t.protocol:location.protocol,search:t.search,query:t.search.slice(1)}},t.isAbsolute=function(e){return 0==e.indexOf("//")||!!~e.indexOf("://")},t.isRelative=function(e){return!t.isAbsolute(e)},t.isCrossDomain=function(e){e=t.parse(e);var n=t.parse(window.location.href);return e.hostname!==n.hostname||e.port!==n.port||e.protocol!==n.protocol}})),tt=(et.parse,et.isAbsolute,et.isRelative,et.isCrossDomain,R((function(e,t){(t=e.exports=function(e){function r(){}function o(){var e=o,r=+new Date,s=r-(n||r);e.diff=s,e.prev=n,e.curr=r,n=r,null==e.useColors&&(e.useColors=t.useColors()),null==e.color&&e.useColors&&(e.color=i());var a=Array.prototype.slice.call(arguments);a[0]=t.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var u=0;a[0]=a[0].replace(/%([a-z%])/g,(function(n,r){if("%%"===n)return n;u++;var i=t.formatters[r];if("function"==typeof i){var o=a[u];n=i.call(e,o),a.splice(u,1),u--}return n})),"function"==typeof t.formatArgs&&(a=t.formatArgs.apply(e,a));var c=o.log||t.log||console.log.bind(console);c.apply(e,a)}r.enabled=!1,o.enabled=!0;var s=t.enabled(e)?o:r;return s.namespace=e,s}).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e);for(var n=(e||"").split(/[\s,]+/),r=n.length,i=0;i<r;i++)n[i]&&("-"===(e=n[i].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=Oe,t.names=[],t.skips=[],t.formatters={};var n,r=0;function i(){return t.colors[r++%t.colors.length]}}))),nt=(tt.coerce,tt.disable,tt.enable,tt.enabled,tt.humanize,tt.names,tt.skips,tt.formatters,R((function(e,t){function n(){var e;try{e=t.storage.debug}catch(e){}return e}(t=e.exports=tt).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(){var e=arguments,n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return e;var r="color: "+this.color;e=[e[0],r,"color: inherit"].concat(Array.prototype.slice.call(e,1));var i=0,o=0;return e[0].replace(/%[a-z%]/g,(function(e){"%%"!==e&&(i++,"%c"===e&&(o=i))})),e.splice(o,0,r),e},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=n,t.useColors=function(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){return JSON.stringify(e)},t.enable(n())}))),rt=(nt.log,nt.formatArgs,nt.save,nt.load,nt.useColors,nt.storage,nt.colors,nt("cookie")),it=function(e,t,n){switch(arguments.length){case 3:case 2:return ot(e,t,n);case 1:return at(e);default:return st()}};function ot(e,t,n){n=n||{};var r=ut(e)+"="+ut(t);null==t&&(n.maxage=-1),n.maxage&&(n.expires=new Date(+new Date+n.maxage)),n.path&&(r+="; path="+n.path),n.domain&&(r+="; domain="+n.domain),n.expires&&(r+="; expires="+n.expires.toUTCString()),n.secure&&(r+="; secure"),document.cookie=r}function st(){var e;try{e=document.cookie}catch(e){return"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e.stack||e),{}}return function(e){var t,n={},r=e.split(/ *; */);if(""==r[0])return n;for(var i=0;i<r.length;++i)t=r[i].split("="),n[ct(t[0])]=ct(t[1]);return n}(e)}function at(e){return st()[e]}function ut(e){try{return encodeURIComponent(e)}catch(t){rt("error `encode(%o)` - %o",e,t)}}function ct(e){try{return decodeURIComponent(e)}catch(t){rt("error `decode(%o)` - %o",e,t)}}for(var lt=R((function(e,t){var n=et.parse;function r(e){for(var n=t.cookie,r=t.levels(e),i=0;i<r.length;++i){var o=r[i],s={domain:"."+o};if(n("__tld__",1,s),n("__tld__"))return n("__tld__",null,s),o}return""}r.levels=function(e){var t=n(e).hostname.split("."),r=t[t.length-1],i=[];if(4===t.length&&r===parseInt(r,10))return i;if(t.length<=1)return i;for(var o=t.length-2;o>=0;--o)i.push(t.slice(o).join("."));return i},r.cookie=it,t=e.exports=r})),dt=new(function(){function e(t){n(this,e),this._options={},this.options(t)}return i(e,[{key:"options",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===arguments.length)return this._options;var t="."+lt(window.location.href);"."===t&&(t=null),this._options=Qe(e,{maxage:31536e6,path:"/",domain:t,samesite:"Lax"}),this.set("test_rudder",!0),this.get("test_rudder")||(this._options.domain=null),this.remove("test_rudder")}},{key:"set",value:function(e,t){try{return t=Xe.stringify(t),Pe(e,t,Ie(this._options)),!0}catch(e){return!1}}},{key:"get",value:function(e){try{var t=Pe(e);return t=t?Xe.parse(t):null}catch(e){return null}}},{key:"remove",value:function(e){try{return Pe(e,null,Ie(this._options)),!0}catch(e){return!1}}}]),e}())({}),ft=function(){var e,t={},n="undefined"!=typeof window?window:x,r=n.document;if(t.disabled=!1,t.version="1.3.20",t.set=function(e,t){},t.get=function(e,t){},t.has=function(e){return void 0!==t.get(e)},t.remove=function(e){},t.clear=function(){},t.transact=function(e,n,r){null==r&&(r=n,n=null),null==n&&(n={});var i=t.get(e,n);r(i),t.set(e,i)},t.getAll=function(){var e={};return t.forEach((function(t,n){e[t]=n})),e},t.forEach=function(){},t.serialize=function(e){return Xe.stringify(e)},t.deserialize=function(e){if("string"==typeof e)try{return Xe.parse(e)}catch(t){return e||void 0}},function(){try{return"localStorage"in n&&n.localStorage}catch(e){return!1}}())e=n.localStorage,t.set=function(n,r){return void 0===r?t.remove(n):(e.setItem(n,t.serialize(r)),r)},t.get=function(n,r){var i=t.deserialize(e.getItem(n));return void 0===i?r:i},t.remove=function(t){e.removeItem(t)},t.clear=function(){e.clear()},t.forEach=function(n){for(var r=0;r<e.length;r++){var i=e.key(r);n(i,t.get(i))}};else if(r&&r.documentElement.addBehavior){var i,o;try{(o=new ActiveXObject("htmlfile")).open(),o.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),o.close(),i=o.w.frames[0].document,e=i.createElement("div")}catch(t){e=r.createElement("div"),i=r.body}var s=function(n){return function(){var r=Array.prototype.slice.call(arguments,0);r.unshift(e),i.appendChild(e),e.addBehavior("#default#userData"),e.load("localStorage");var o=n.apply(t,r);return i.removeChild(e),o}},a=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),u=function(e){return e.replace(/^d/,"___$&").replace(a,"___")};t.set=s((function(e,n,r){return n=u(n),void 0===r?t.remove(n):(e.setAttribute(n,t.serialize(r)),e.save("localStorage"),r)})),t.get=s((function(e,n,r){n=u(n);var i=t.deserialize(e.getAttribute(n));return void 0===i?r:i})),t.remove=s((function(e,t){t=u(t),e.removeAttribute(t),e.save("localStorage")})),t.clear=s((function(e){var t=e.XMLDocument.documentElement.attributes;e.load("localStorage");for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save("localStorage")})),t.forEach=s((function(e,n){for(var r,i=e.XMLDocument.documentElement.attributes,o=0;r=i[o];++o)n(r.name,t.deserialize(e.getAttribute(r.name)))}))}try{var c="__storejs__";t.set(c,c),t.get(c)!=c&&(t.disabled=!0),t.remove(c)}catch(e){t.disabled=!0}return t.enabled=!t.disabled,t}(),pt=new(function(){function e(t){n(this,e),this._options={},this.enabled=!1,this.options(t)}return i(e,[{key:"options",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(0===arguments.length)return this._options;Qe(e,{enabled:!0}),this.enabled=e.enabled&&ft.enabled,this._options=e}},{key:"set",value:function(e,t){return!!this.enabled&&ft.set(e,t)}},{key:"get",value:function(e){return this.enabled?ft.get(e):null}},{key:"remove",value:function(e){return!!this.enabled&&ft.remove(e)}}]),e}())({}),ht="rl_user_id",gt="rl_trait",yt="rl_anonymous_id",mt="rl_group_id",vt="rl_group_trait",bt=new(function(){function e(){if(n(this,e),dt.set("rudder_cookies",!0),dt.get("rudder_cookies"))return dt.remove("rudder_cookies"),void(this.storage=dt);pt.enabled&&(this.storage=pt)}return i(e,[{key:"setItem",value:function(e,t){this.storage.set(e,t)}},{key:"setUserId",value:function(e){"string"==typeof e?this.storage.set(ht,e):p("[Storage] setUserId:: userId should be string")}},{key:"setUserTraits",value:function(e){this.storage.set(gt,e)}},{key:"setGroupId",value:function(e){"string"==typeof e?this.storage.set(mt,e):p("[Storage] setGroupId:: groupId should be string")}},{key:"setGroupTraits",value:function(e){this.storage.set(vt,e)}},{key:"setAnonymousId",value:function(e){"string"==typeof e?this.storage.set(yt,e):p("[Storage] setAnonymousId:: anonymousId should be string")}},{key:"getItem",value:function(e){return this.storage.get(e)}},{key:"getUserId",value:function(){return this.storage.get(ht)}},{key:"getUserTraits",value:function(){return this.storage.get(gt)}},{key:"getGroupId",value:function(){return this.storage.get(mt)}},{key:"getGroupTraits",value:function(){return this.storage.get(vt)}},{key:"getAnonymousId",value:function(){return this.storage.get(yt)}},{key:"removeItem",value:function(e){return this.storage.remove(e)}},{key:"clear",value:function(){this.storage.remove(ht),this.storage.remove(gt),this.storage.remove(yt)}}]),e}()),wt="lt_synch_timestamp",kt=new(function(){function e(){n(this,e),this.storage=bt}return i(e,[{key:"setLotameSynchTime",value:function(e){this.storage.setItem(wt,e)}},{key:"getLotameSynchTime",value:function(){return this.storage.getItem(wt)}}]),e}()),_t={HS:E,GA:A,HOTJAR:T,GOOGLEADS:C,VWO:O,GTM:S,BRAZE:j,INTERCOM:K,KEEN:q,KISSMETRICS:he,CUSTOMERIO:ge,CHARTBEAT:we,COMSCORE:ke,LOTAME:function(){function e(t,r){var i=this;n(this,e),this.name="LOTAME",this.analytics=r,this.storage=kt,this.bcpUrlSettings=t.bcpUrlSettings,this.dspUrlSettings=t.dspUrlSettings,this.mappings={},t.mappings.forEach((function(e){var t=e.key,n=e.value;i.mappings[t]=n}))}return i(e,[{key:"init",value:function(){f("===in init Lotame==="),window.LOTAME_SYNCH_CALLBACK=function(){}}},{key:"addPixel",value:function(e,t,n){var r=document.createElement("img");r.src=e,r.setAttribute("width",t),r.setAttribute("height",n),document.getElementsByTagName("body")[0].appendChild(r)}},{key:"syncPixel",value:function(e){var t=this;f("===== in syncPixel ======"),this.dspUrlSettings&&this.dspUrlSettings.length>0&&this.dspUrlSettings.forEach((function(n){var r=t.compileUrl(a(a({},t.mappings),{},{userId:e}),n.dspUrlTemplate);t.addPixel(r,"1","1")})),this.storage.setLotameSynchTime(Date.now()),this.analytics.methodToCallbackMapping.syncPixel&&this.analytics.emit("syncPixel",{destination:this.name})}},{key:"compileUrl",value:function(e,t){return Object.keys(e).forEach((function(n){if(e.hasOwnProperty(n)){var r=new RegExp("{{"+n+"}}","gi");t=t.replace(r,e[n])}})),t}},{key:"identify",value:function(e){f("in Lotame identify");var t=e.message.userId;this.syncPixel(t)}},{key:"track",value:function(e){f("track not supported for lotame")}},{key:"page",value:function(e){var t=this;f("in Lotame page"),this.bcpUrlSettings&&this.bcpUrlSettings.length>0&&this.bcpUrlSettings.forEach((function(e){var n=t.compileUrl(a({},t.mappings),e.bcpUrlTemplate);t.addPixel(n,"1","1")})),e.message.userId&&this.isPixelToBeSynched()&&this.syncPixel(e.message.userId)}},{key:"isPixelToBeSynched",value:function(){var e=this.storage.getLotameSynchTime(),t=Date.now();return!e||Math.floor((t-e)/864e5)>=7}},{key:"isLoaded",value:function(){return f("in Lotame isLoaded"),!0}},{key:"isReady",value:function(){return!0}}]),e}()},It=function e(){n(this,e),this.build="1.0.0",this.name="RudderLabs JavaScript SDK",this.namespace="com.rudderlabs.javascript",this.version="1.1.1"},Et=function e(){n(this,e),this.name="RudderLabs JavaScript SDK",this.version="1.1.1"},At=function e(){n(this,e),this.name="",this.version=""},Tt=function e(){n(this,e),this.density=0,this.width=0,this.height=0},Ct=function e(){n(this,e),this.app=new It,this.traits=null,this.library=new Et;var t=new At;t.version="";var r=new Tt;r.width=window.width,r.height=window.height,r.density=window.devicePixelRatio,this.userAgent=navigator.userAgent,this.locale=navigator.language||navigator.browserLanguage,this.os=t,this.screen=r,this.device=null,this.network=null},Ot=function(){function e(){n(this,e),this.channel="web",this.context=new Ct,this.type=null,this.action=null,this.messageId=g().toString(),this.originalTimestamp=(new Date).toISOString(),this.anonymousId=null,this.userId=null,this.event=null,this.properties={},this.integrations={},this.integrations.All=!0}return i(e,[{key:"getProperty",value:function(e){return this.properties[e]}},{key:"addProperty",value:function(e,t){this.properties[e]=t}},{key:"validateFor",value:function(e){if(!this.properties)throw new Error("Key properties is required");switch(e){case k.TRACK:if(!this.event)throw new Error("Key event is required for track event");if(this.event in Object.values(_))switch(this.event){case _.CHECKOUT_STEP_VIEWED:case _.CHECKOUT_STEP_COMPLETED:case _.PAYMENT_INFO_ENTERED:this.checkForKey("checkout_id"),this.checkForKey("step");break;case _.PROMOTION_VIEWED:case _.PROMOTION_CLICKED:this.checkForKey("promotion_id");break;case _.ORDER_REFUNDED:this.checkForKey("order_id")}else this.properties.category||(this.properties.category=this.event);break;case k.PAGE:break;case k.SCREEN:if(!this.properties.name)throw new Error("Key 'name' is required in properties")}}},{key:"checkForKey",value:function(e){if(!this.properties[e])throw new Error("Key '"+e+"' is required in properties")}}]),e}(),St=function(){function e(){n(this,e),this.message=new Ot}return i(e,[{key:"setType",value:function(e){this.message.type=e}},{key:"setProperty",value:function(e){this.message.properties=e}},{key:"setUserProperty",value:function(e){this.message.user_properties=e}},{key:"setUserId",value:function(e){this.message.userId=e}},{key:"setEventName",value:function(e){this.message.event=e}},{key:"updateTraits",value:function(e){this.message.context.traits=e}},{key:"getElementContent",value:function(){return this.message}}]),e}(),jt=function(){function e(){n(this,e),this.rudderProperty=null,this.rudderUserProperty=null,this.event=null,this.userId=null,this.channel=null,this.type=null}return i(e,[{key:"setProperty",value:function(e){return this.rudderProperty=e,this}},{key:"setPropertyBuilder",value:function(e){return this.rudderProperty=e.build(),this}},{key:"setUserProperty",value:function(e){return this.rudderUserProperty=e,this}},{key:"setUserPropertyBuilder",value:function(e){return this.rudderUserProperty=e.build(),this}},{key:"setEvent",value:function(e){return this.event=e,this}},{key:"setUserId",value:function(e){return this.userId=e,this}},{key:"setChannel",value:function(e){return this.channel=e,this}},{key:"setType",value:function(e){return this.type=e,this}},{key:"build",value:function(){var e=new St;return e.setUserId(this.userId),e.setType(this.type),e.setEventName(this.event),e.setProperty(this.rudderProperty),e.setUserProperty(this.rudderUserProperty),e}}]),e}(),xt=function e(){n(this,e),this.batch=null,this.writeKey=null},Rt=R((function(e){var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var r=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),r[t]=e>>>((3&t)<<3)&255;return r}}})),Pt=[],Ut=0;Ut<256;++Ut)Pt[Ut]=(Ut+256).toString(16).substr(1);var Dt,Nt,Lt=function(e,t){var n=t||0,r=Pt;return[r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],"-",r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]],r[e[n++]]].join("")},Mt=0,Bt=0;var Ft=function(e,t,n){var r=t&&n||0,i=t||[],o=(e=e||{}).node||Dt,s=void 0!==e.clockseq?e.clockseq:Nt;if(null==o||null==s){var a=Rt();null==o&&(o=Dt=[1|a[0],a[1],a[2],a[3],a[4],a[5]]),null==s&&(s=Nt=16383&(a[6]<<8|a[7]))}var u=void 0!==e.msecs?e.msecs:(new Date).getTime(),c=void 0!==e.nsecs?e.nsecs:Bt+1,l=u-Mt+(c-Bt)/1e4;if(l<0&&void 0===e.clockseq&&(s=s+1&16383),(l<0||u>Mt)&&void 0===e.nsecs&&(c=0),c>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Mt=u,Bt=c,Nt=s;var d=(1e4*(268435455&(u+=122192928e5))+c)%4294967296;i[r++]=d>>>24&255,i[r++]=d>>>16&255,i[r++]=d>>>8&255,i[r++]=255&d;var f=u/4294967296*1e4&268435455;i[r++]=f>>>8&255,i[r++]=255&f,i[r++]=f>>>24&15|16,i[r++]=f>>>16&255,i[r++]=s>>>8|128,i[r++]=255&s;for(var p=0;p<6;++p)i[r+p]=o[p];return t||Lt(i)};var Kt=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||Rt)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var o=0;o<16;++o)t[r+o]=i[o];return t||Lt(i)},qt=Kt;qt.v1=Ft,qt.v4=Kt;var Gt=qt,Ht=Object.prototype.hasOwnProperty,Vt=String.prototype.charAt,zt=Object.prototype.toString,Jt=function(e,t){return Vt.call(e,t)},Wt=function(e,t){return Ht.call(e,t)},$t=function(e,t){t=t||Wt;for(var n=[],r=0,i=e.length;r<i;r+=1)t(e,r)&&n.push(String(r));return n},Yt=function(e){return null==e?[]:(t=e,"[object String]"===zt.call(t)?$t(e,Jt):function(e){return null!=e&&"function"!=typeof e&&"number"==typeof e.length}(e)?$t(e,Wt):function(e,t){t=t||Wt;var n=[];for(var r in e)t(e,r)&&n.push(String(r));return n}(e));var t},Qt=Gt.v4,Zt={_data:{},length:0,setItem:function(e,t){return this._data[e]=t,this.length=Yt(this._data).length,t},getItem:function(e){return e in this._data?this._data[e]:null},removeItem:function(e){return e in this._data&&delete this._data[e],this.length=Yt(this._data).length,null},clear:function(){this._data={},this.length=0},key:function(e){return Yt(this._data)[e]}};var Xt={defaultEngine:function(){try{if(!window.localStorage)return!1;var e=Qt();window.localStorage.setItem(e,"test_value");var t=window.localStorage.getItem(e);return window.localStorage.removeItem(e),"test_value"===t}catch(e){return!1}}()?window.localStorage:Zt,inMemoryEngine:Zt},en=Object.prototype.toString,tn="function"==typeof Array.isArray?Array.isArray:function(e){return"[object Array]"===en.call(e)},nn=function(e){return null!=e&&(tn(e)||"function"!==e&&function(e){var t=typeof e;return"number"===t||"object"===t&&"[object Number]"===en.call(e)}(e.length))},rn=function(e,t){for(var n=0;n<t.length&&!1!==e(t[n],n,t);n+=1);},on=function(e,t){for(var n=Yt(t),r=0;r<n.length&&!1!==e(t[n[r]],n[r],t);r+=1);},sn=function(e,t){return(nn(t)?rn:on).call(this,e,t)},an=Xt.defaultEngine,un=Xt.inMemoryEngine;function cn(e,t,n,r){this.id=t,this.name=e,this.keys=n||{},this.engine=r||an}cn.prototype.set=function(e,t){var n=this._createValidKey(e);if(n)try{this.engine.setItem(n,Xe.stringify(t))}catch(n){(function(e){var t=!1;if(e.code)switch(e.code){case 22:t=!0;break;case 1014:"NS_ERROR_DOM_QUOTA_REACHED"===e.name&&(t=!0)}else-2147024882===e.number&&(t=!0);return t})(n)&&(this._swapEngine(),this.set(e,t))}},cn.prototype.get=function(e){try{var t=this.engine.getItem(this._createValidKey(e));return null===t?null:Xe.parse(t)}catch(e){return null}},cn.prototype.remove=function(e){this.engine.removeItem(this._createValidKey(e))},cn.prototype._createValidKey=function(e){var t,n=this.name,r=this.id;return Yt(this.keys).length?(sn((function(i){i===e&&(t=[n,r,e].join("."))}),this.keys),t):[n,r,e].join(".")},cn.prototype._swapEngine=function(){var e=this;sn((function(t){var n=e.get(t);un.setItem([e.name,e.id,t].join("."),n),e.remove(t)}),this.keys),this.engine=un};var ln=cn;var dn={setTimeout:function(e,t){return window.setTimeout(e,t)},clearTimeout:function(e){return window.clearTimeout(e)},Date:window.Date},fn=dn;function pn(){this.tasks={},this.nextId=1}pn.prototype.now=function(){return+new fn.Date},pn.prototype.run=function(e,t){var n=this.nextId++;return this.tasks[n]=fn.setTimeout(this._handle(n,e),t),n},pn.prototype.cancel=function(e){this.tasks[e]&&(fn.clearTimeout(this.tasks[e]),delete this.tasks[e])},pn.prototype.cancelAll=function(){sn(fn.clearTimeout,this.tasks),this.tasks={}},pn.prototype._handle=function(e,t){var n=this;return function(){return delete n.tasks[e],t()}},pn.setClock=function(e){fn=e},pn.resetClock=function(){fn=dn};var hn=pn,gn=yn;function yn(e){return yn.enabled(e)?function(t){t=mn(t);var n=new Date,r=n-(yn[e]||n);yn[e]=n,t=e+" "+t+" +"+yn.humanize(r),window.console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}:function(){}}function mn(e){return e instanceof Error?e.stack||e.message:e}yn.names=[],yn.skips=[],yn.enable=function(e){try{localStorage.debug=e}catch(e){}for(var t=(e||"").split(/[\s,]+/),n=t.length,r=0;r<n;r++)"-"===(e=t[r].replace("*",".*?"))[0]?yn.skips.push(new RegExp("^"+e.substr(1)+"$")):yn.names.push(new RegExp("^"+e+"$"))},yn.disable=function(){yn.enable("")},yn.humanize=function(e){return e>=36e5?(e/36e5).toFixed(1)+"h":e>=6e4?(e/6e4).toFixed(1)+"m":e>=1e3?(e/1e3|0)+"s":e+"ms"},yn.enabled=function(e){for(var t=0,n=yn.skips.length;t<n;t++)if(yn.skips[t].test(e))return!1;for(t=0,n=yn.names.length;t<n;t++)if(yn.names[t].test(e))return!0;return!1};try{window.localStorage&&yn.enable(localStorage.debug)}catch(e){}var vn=R((function(e){function t(e){if(e)return function(e){for(var n in t.prototype)e[n]=t.prototype[n];return e}(e)}e.exports=t,t.prototype.on=t.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},t.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},t.prototype.off=t.prototype.removeListener=t.prototype.removeAllListeners=t.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var i=0;i<r.length;i++)if((n=r[i])===t||n.fn===t){r.splice(i,1);break}return 0===r.length&&delete this._callbacks["$"+e],this},t.prototype.emit=function(e){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),n=this._callbacks["$"+e],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(n){r=0;for(var i=(n=n.slice(0)).length;r<i;++r)n[r].apply(this,t)}return this},t.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},t.prototype.hasListeners=function(e){return!!this.listeners(e).length}})),bn=Gt.v4,wn=gn("localstorage-retry");function kn(e,t){return function(){return e.apply(t,arguments)}}function _n(e,t,n){"function"==typeof t&&(n=t),this.name=e,this.id=bn(),this.fn=n,this.maxItems=t.maxItems||1/0,this.maxAttempts=t.maxAttempts||1/0,this.backoff={MIN_RETRY_DELAY:t.minRetryDelay||1e3,MAX_RETRY_DELAY:t.maxRetryDelay||3e4,FACTOR:t.backoffFactor||2,JITTER:t.backoffJitter||0},this.timeouts={ACK_TIMER:1e3,RECLAIM_TIMER:3e3,RECLAIM_TIMEOUT:1e4,RECLAIM_WAIT:500},this.keys={IN_PROGRESS:"inProgress",QUEUE:"queue",ACK:"ack",RECLAIM_START:"reclaimStart",RECLAIM_END:"reclaimEnd"},this._schedule=new hn,this._processId=0,this._store=new ln(this.name,this.id,this.keys),this._store.set(this.keys.IN_PROGRESS,{}),this._store.set(this.keys.QUEUE,[]),this._ack=kn(this._ack,this),this._checkReclaim=kn(this._checkReclaim,this),this._processHead=kn(this._processHead,this),this._running=!1}vn(_n.prototype),_n.prototype.start=function(){this._running&&this.stop(),this._running=!0,this._ack(),this._checkReclaim(),this._processHead()},_n.prototype.stop=function(){this._schedule.cancelAll(),this._running=!1},_n.prototype.shouldRetry=function(e,t){return!(t>this.maxAttempts)},_n.prototype.getDelay=function(e){var t=this.backoff.MIN_RETRY_DELAY*Math.pow(this.backoff.FACTOR,e);if(this.backoff.JITTER){var n=Math.random(),r=Math.floor(n*this.backoff.JITTER*t);Math.floor(10*n)<5?t-=r:t+=r}return Number(Math.min(t,this.backoff.MAX_RETRY_DELAY).toPrecision(1))},_n.prototype.addItem=function(e){this._enqueue({item:e,attemptNumber:0,time:this._schedule.now()})},_n.prototype.requeue=function(e,t,n){this.shouldRetry(e,t,n)?this._enqueue({item:e,attemptNumber:t,time:this._schedule.now()+this.getDelay(t)}):this.emit("discard",e,t)},_n.prototype._enqueue=function(e){var t=this._store.get(this.keys.QUEUE)||[];(t=t.slice(-(this.maxItems-1))).push(e),t=t.sort((function(e,t){return e.time-t.time})),this._store.set(this.keys.QUEUE,t),this._running&&this._processHead()},_n.prototype._processHead=function(){var e=this,t=this._store;this._schedule.cancel(this._processId);var n=t.get(this.keys.QUEUE)||[],r=t.get(this.keys.IN_PROGRESS)||{},i=this._schedule.now(),o=[];function s(n,r){o.push({item:n.item,done:function(i,o){var s=t.get(e.keys.IN_PROGRESS)||{};delete s[r],t.set(e.keys.IN_PROGRESS,s),e.emit("processed",i,o,n.item),i&&e.requeue(n.item,n.attemptNumber+1,i)}})}for(var a=Object.keys(r).length;n.length&&n[0].time<=i&&a++<e.maxItems;){var u=n.shift(),c=bn();r[c]={item:u.item,attemptNumber:u.attemptNumber,time:e._schedule.now()},s(u,c)}t.set(this.keys.QUEUE,n),t.set(this.keys.IN_PROGRESS,r),sn((function(t){try{e.fn(t.item,t.done)}catch(e){wn("Process function threw error: "+e)}}),o),n=t.get(this.keys.QUEUE)||[],this._schedule.cancel(this._processId),n.length>0&&(this._processId=this._schedule.run(this._processHead,n[0].time-i))},_n.prototype._ack=function(){this._store.set(this.keys.ACK,this._schedule.now()),this._store.set(this.keys.RECLAIM_START,null),this._store.set(this.keys.RECLAIM_END,null),this._schedule.run(this._ack,this.timeouts.ACK_TIMER)},_n.prototype._checkReclaim=function(){var e=this;sn((function(t){t.id!==e.id&&(e._schedule.now()-t.get(e.keys.ACK)<e.timeouts.RECLAIM_TIMEOUT||function(t){t.set(e.keys.RECLAIM_START,e.id),t.set(e.keys.ACK,e._schedule.now()),e._schedule.run((function(){t.get(e.keys.RECLAIM_START)===e.id&&(t.set(e.keys.RECLAIM_END,e.id),e._schedule.run((function(){t.get(e.keys.RECLAIM_END)===e.id&&t.get(e.keys.RECLAIM_START)===e.id&&e._reclaim(t.id)}),e.timeouts.RECLAIM_WAIT))}),e.timeouts.RECLAIM_WAIT)}(t))}),function(t){for(var n=[],r=e._store.engine,i=0;i<r.length;i++){var o=r.key(i).split(".");3===o.length&&(o[0]===t&&"ack"===o[2]&&n.push(new ln(t,o[1],e.keys)))}return n}(this.name)),this._schedule.run(this._checkReclaim,this.timeouts.RECLAIM_TIMER)},_n.prototype._reclaim=function(e){var t=this,n=new ln(this.name,e,this.keys),r={queue:this._store.get(this.keys.QUEUE)||[]},i={inProgress:n.get(this.keys.IN_PROGRESS)||{},queue:n.get(this.keys.QUEUE)||[]};sn((function(e){r.queue.push({item:e.item,attemptNumber:e.attemptNumber,time:t._schedule.now()})}),i.queue),sn((function(e){r.queue.push({item:e.item,attemptNumber:e.attemptNumber+1,time:t._schedule.now()})}),i.inProgress),r.queue=r.queue.sort((function(e,t){return e.time-t.time})),this._store.set(this.keys.QUEUE,r.queue),n.remove(this.keys.ACK),n.remove(this.keys.RECLAIM_START),n.remove(this.keys.RECLAIM_END),n.remove(this.keys.IN_PROGRESS),n.remove(this.keys.QUEUE),this._processHead()};var In=_n,En={maxRetryDelay:36e4,minRetryDelay:1e3,backoffFactor:0},An=new(function(){function e(){n(this,e),this.eventsBuffer=[],this.writeKey="",this.url="https://hosted-dataplane.rudderstack.com",this.state="READY",this.batchSize=0,this.payloadQueue=new In("rudder",En,(function(e,t){e.message.sentAt=y(),An.processQueueElement(e.url,e.headers,e.message,1e4,(function(e,n){if(e)return t(e);t(null,n)}))})),this.payloadQueue.start()}return i(e,[{key:"preaparePayloadAndFlush",value:function(e){if(f("==== in preaparePayloadAndFlush with state: "+e.state),f(e.eventsBuffer),0!=e.eventsBuffer.length&&"PROCESSING"!==e.state){var t=e.eventsBuffer,n=new xt;n.batch=t,n.writeKey=e.writeKey,n.sentAt=y(),n.batch.forEach((function(e){e.sentAt=n.sentAt})),e.batchSize=e.eventsBuffer.length;var r=new XMLHttpRequest;f("==== in flush sending to Rudder BE ===="),f(JSON.stringify(n,h)),r.open("POST",e.url,!0),r.setRequestHeader("Content-Type","application/json"),r.setRequestHeader("Authorization","Basic "+btoa(n.writeKey+":")),r.onreadystatechange=function(){4===r.readyState&&200===r.status?(f("====== request processed successfully: "+r.status),e.eventsBuffer=e.eventsBuffer.slice(e.batchSize),f(e.eventsBuffer.length)):4===r.readyState&&200!==r.status&&m(new Error("request failed with status: "+r.status+" for url: "+e.url)),e.state="READY"},r.send(JSON.stringify(n,h)),e.state="PROCESSING"}}},{key:"processQueueElement",value:function(e,t,n,r,i){try{var o=new XMLHttpRequest;for(var s in o.open("POST",e,!0),t)o.setRequestHeader(s,t[s]);o.timeout=r,o.ontimeout=i,o.onerror=i,o.onreadystatechange=function(){4===o.readyState&&(429===o.status||o.status>=500&&o.status<600?(m(new Error("request failed with status: "+o.status+o.statusText+" for url: "+e)),i(new Error("request failed with status: "+o.status+o.statusText+" for url: "+e))):(f("====== request processed successfully: "+o.status),i(null,o.status)))},o.send(JSON.stringify(n,h))}catch(e){i(e)}}},{key:"enqueue",value:function(e,t){var n={"Content-Type":"application/json",Authorization:"Basic "+btoa(this.writeKey+":")},r=e.getElementContent();r.originalTimestamp=y(),r.sentAt=y(),JSON.stringify(r).length>32e3&&p("[EventRepository] enqueue:: message length greater 32 Kb ",r);var i="/"==this.url.slice(-1)?this.url.slice(0,-1):this.url;this.payloadQueue.addItem({url:i+"/v1/"+t,headers:n,message:r})}}]),e}());function Tn(e){var t=function(t){var n=(t=t||window.event).target||t.srcElement;xn(n)&&(n=n.parentNode),On(n,t)?f("to be tracked ",t.type):f("not to be tracked ",t.type),function(e,t){var n=e.target||e.srcElement,r=void 0;xn(n)&&(n=n.parentNode);if(On(n,e)){if("form"==n.tagName.toLowerCase()){r={};for(var i=0;i<n.elements.length;i++){var o=n.elements[i];if(Un(o)&&Pn(o,t.trackValues)){var s=o.id?o.id:o.name;if(s&&"string"==typeof s){var a=o.id?o.id:o.name,u=o.id?document.getElementById(o.id).value:document.getElementsByName(o.name)[0].value;"checkbox"!==o.type&&"radio"!==o.type||(u=o.checked),""!==a.trim()&&(r[encodeURIComponent(a)]=encodeURIComponent(u))}}}}for(var c=[n],l=n;l.parentNode&&!Sn(l,"body");)c.push(l.parentNode),l=l.parentNode;var d,p=[],h=!1;if(c.forEach((function(e){var n=function(e){return!(!e.parentNode||Sn(e,"body"))}(e);"a"===e.tagName.toLowerCase()&&(d=e.getAttribute("href"),d=n&&d),h=h||!Un(e),p.push(function(e,t){for(var n={classes:Rn(e).split(" "),tag_name:e.tagName.toLowerCase()},r=e.attributes.length,i=0;i<r;i++){var o=e.attributes[i].name,s=e.attributes[i].value;s&&(n["attr__"+o]=s),"name"!=o&&"id"!=o||!Pn(e,t.trackValues)||(n.field_value="id"==o?document.getElementById(s).value:document.getElementsByName(s)[0].value,"checkbox"!==e.type&&"radio"!==e.type||(n.field_value=e.checked))}var a=1,u=1,c=e;for(;c=Dn(c);)a++,c.tagName===e.tagName&&u++;return n.nth_child=a,n.nth_of_type=u,n}(e,t))})),h)return!1;var g="",y=function(e){var t="";return e.childNodes.forEach((function(e){e.nodeType===Node.TEXT_NODE&&(t+=e.nodeValue)})),t.trim()}(n);y&&y.length&&(g=y);var m={event_type:e.type,page:v(),elements:p,el_attr_href:d,el_text:g};r&&(m.form_values=r),f("web_event",m),t.track("autotrack",m)}}(t,e)};Cn(document,"submit",t,!0),Cn(document,"change",t,!0),Cn(document,"click",t,!0),e.page()}function Cn(e,t,n,r){e?e.addEventListener(t,n,!!r):p("[Autotrack] register_event:: No valid element provided to register_event")}function On(e,t){if(!e||Sn(e,"html")||!jn(e))return!1;switch(e.tagName.toLowerCase()){case"html":return!1;case"form":return"submit"===t.type;case"input":return-1===["button","submit"].indexOf(e.getAttribute("type"))?"change"===t.type:"click"===t.type;case"select":case"textarea":return"change"===t.type;default:return"click"===t.type}}function Sn(e,t){return e&&e.tagName&&e.tagName.toLowerCase()===t.toLowerCase()}function jn(e){return e&&1===e.nodeType}function xn(e){return e&&3===e.nodeType}function Rn(e){switch(t(e.className)){case"string":return e.className;case"object":return e.className.baseVal||e.getAttribute("class")||"";default:return""}}function Pn(e,t){for(var n=e.attributes.length,r=0;r<n;r++){var i=e.attributes[r].value;if(t.indexOf(i)>-1)return!0}return!1}function Un(e){return!(Rn(e).split(" ").indexOf("rudder-no-track")>=0)}function Dn(e){if(e.previousElementSibling)return e.previousElementSibling;do{e=e.previousSibling}while(e&&!jn(e));return e}var Nn=function(e,t,n){var r=!1;return n=n||Ln,i.count=e,0===e?t():i;function i(e,o){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(r=!0,t(e),t=n):0!==i.count||r||t(null,o)}};function Ln(){}function Mn(e,t){this.eventRepository||(this.eventRepository=An),this.eventRepository.enqueue(e,t)}var Bn=function(){function e(){n(this,e),this.autoTrackHandlersRegistered=!1,this.autoTrackFeatureEnabled=!1,this.initialized=!1,this.trackValues=[],this.eventsBuffer=[],this.clientIntegrations=[],this.configArray=[],this.clientIntegrationObjects=void 0,this.successfullyLoadedIntegration=[],this.failedToBeLoadedIntegration=[],this.toBeProcessedArray=[],this.toBeProcessedByIntegrationArray=[],this.storage=bt,this.userId=null!=this.storage.getUserId()?this.storage.getUserId():"",this.userTraits=null!=this.storage.getUserTraits()?this.storage.getUserTraits():{},this.groupId=null!=this.storage.getGroupId()?this.storage.getGroupId():"",this.groupTraits=null!=this.storage.getGroupTraits()?this.storage.getGroupTraits():{},this.anonymousId=this.getAnonymousId(),this.storage.setUserId(this.userId),this.eventRepository=An,this.readyCallback=function(){},this.executeReadyCallback=void 0,this.methodToCallbackMapping={syncPixel:"syncPixelCallback"}}return i(e,[{key:"processResponse",value:function(e,t){try{f("===in process response=== "+e),(t=JSON.parse(t)).source.useAutoTracking&&!this.autoTrackHandlersRegistered&&(this.autoTrackFeatureEnabled=!0,Tn(this),this.autoTrackHandlersRegistered=!0),t.source.destinations.forEach((function(e,t){f("Destination "+t+" Enabled? "+e.enabled+" Type: "+e.destinationDefinition.name+" Use Native SDK? "+e.config.useNativeSDK),e.enabled&&(this.clientIntegrations.push(e.destinationDefinition.name),this.configArray.push(e.config))}),this),this.init(this.clientIntegrations,this.configArray)}catch(e){m(e),f("===handling config BE response processing error==="),f("autoTrackHandlersRegistered",this.autoTrackHandlersRegistered),this.autoTrackFeatureEnabled&&!this.autoTrackHandlersRegistered&&(Tn(this),this.autoTrackHandlersRegistered=!0)}}},{key:"init",value:function(e,t){var n=this,r=this;if(f("supported intgs ",_t),!e||0==e.length)return this.readyCallback&&this.readyCallback(),void(this.toBeProcessedByIntegrationArray=[]);e.forEach((function(e,i){var o=new(0,_t[e])(t[i],r);o.init(),f("initializing destination: ",e),n.isInitialized(o).then(n.replayEvents)}))}},{key:"replayEvents",value:function(e){e.successfullyLoadedIntegration.length+e.failedToBeLoadedIntegration.length==e.clientIntegrations.length&&e.toBeProcessedByIntegrationArray.length>0&&(f("===replay events called====",e.successfullyLoadedIntegration.length,e.failedToBeLoadedIntegration.length),e.clientIntegrationObjects=[],e.clientIntegrationObjects=e.successfullyLoadedIntegration,f("==registering after callback===",e.clientIntegrationObjects.length),e.executeReadyCallback=Nn(e.clientIntegrationObjects.length,e.readyCallback),f("==registering ready callback==="),e.on("ready",e.executeReadyCallback),e.clientIntegrationObjects.forEach((function(t){f("===looping over each successful integration===="),t.isReady&&!t.isReady()||(f("===letting know I am ready=====",t.name),e.emit("ready"))})),e.toBeProcessedByIntegrationArray.forEach((function(t){var n=t[0];t.shift();for(var r=t[0].message.integrations,i=0;i<e.clientIntegrationObjects.length;i++)if(r[e.clientIntegrationObjects[i].name]||null==r[e.clientIntegrationObjects[i].name]&&r.All)try{var o;if(!e.clientIntegrationObjects[i].isFailed||!e.clientIntegrationObjects[i].isFailed())(o=e.clientIntegrationObjects[i])[n].apply(o,u(t))}catch(e){m(e)}})),e.toBeProcessedByIntegrationArray=[])}},{key:"pause",value:function(e){return new Promise((function(t){setTimeout(t,e)}))}},{key:"isInitialized",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return new Promise((function(r){return e.isLoaded()?(f("===integration loaded successfully====",e.name),t.successfullyLoadedIntegration.push(e),r(t)):n>=1e4?(f("====max wait over===="),t.failedToBeLoadedIntegration.push(e),r(t)):void t.pause(1e3).then((function(){return f("====after pause, again checking===="),t.isInitialized(e,n+1e3).then(r)}))}))}},{key:"page",value:function(e,n,r,i,o){"function"==typeof i&&(o=i,i=null),"function"==typeof r&&(o=r,i=r=null),"function"==typeof n&&(o=n,i=r=n=null),"object"===t(e)&&(i=n,r=e,n=e=null),"object"===t(n)&&(i=r,r=n,n=null),"string"==typeof e&&"string"!=typeof n&&(n=e,e=null),this.processPage(e,n,r,i,o)}},{key:"track",value:function(e,t,n,r){"function"==typeof n&&(r=n,n=null),"function"==typeof t&&(r=t,n=null,t=null),this.processTrack(e,t,n,r)}},{key:"identify",value:function(e,n,r,i){"function"==typeof r&&(i=r,r=null),"function"==typeof n&&(i=n,r=null,n=null),"object"==t(e)&&(r=n,n=e,e=this.userId),this.processIdentify(e,n,r,i)}},{key:"alias",value:function(e,n,r,i){"function"==typeof r&&(i=r,r=null),"function"==typeof n&&(i=n,r=null,n=null),"object"==t(n)&&(r=n,n=null);var o=(new jt).setType("alias").build();o.message.previousId=n||this.userId?this.userId:this.getAnonymousId(),o.message.userId=e,this.processAndSendDataToDestinations("alias",o,r,i)}},{key:"group",value:function(e,n,r,i){if(arguments.length){"function"==typeof r&&(i=r,r=null),"function"==typeof n&&(i=n,r=null,n=null),"object"==t(e)&&(r=n,n=e,e=this.groupId),this.groupId=e,this.storage.setGroupId(this.groupId);var o=(new jt).setType("group").build();if(n)for(var s in n)this.groupTraits[s]=n[s];else this.groupTraits={};this.storage.setGroupTraits(this.groupTraits),this.processAndSendDataToDestinations("group",o,r,i)}}},{key:"processPage",value:function(e,t,n,r,i){var o=(new jt).setType("page").build();t&&(o.message.name=t),n||(n={}),e&&(n.category=e),n&&(o.message.properties=this.getPageProperties(n)),this.trackPage(o,r,i)}},{key:"processTrack",value:function(e,t,n,r){var i=(new jt).setType("track").build();e&&i.setEventName(e),t?i.setProperty(t):i.setProperty({}),this.trackEvent(i,n,r)}},{key:"processIdentify",value:function(e,t,n,r){e&&this.userId&&e!==this.userId&&this.reset(),this.userId=e,this.storage.setUserId(this.userId);var i=(new jt).setType("identify").build();if(t){for(var o in t)this.userTraits[o]=t[o];this.storage.setUserTraits(this.userTraits)}this.identifyUser(i,n,r)}},{key:"identifyUser",value:function(e,t,n){e.message.userId&&(this.userId=e.message.userId,this.storage.setUserId(this.userId)),e&&e.message&&e.message.context&&e.message.context.traits&&(this.userTraits=Object.assign({},e.message.context.traits),this.storage.setUserTraits(this.userTraits)),this.processAndSendDataToDestinations("identify",e,t,n)}},{key:"trackPage",value:function(e,t,n){this.processAndSendDataToDestinations("page",e,t,n)}},{key:"trackEvent",value:function(e,t,n){this.processAndSendDataToDestinations("track",e,t,n)}},{key:"processAndSendDataToDestinations",value:function(e,t,n,r){try{this.anonymousId||this.setAnonymousId(),t.message.context.page=v(),t.message.context.traits=Object.assign({},this.userTraits),f("anonymousId: ",this.anonymousId),t.message.anonymousId=this.anonymousId,t.message.userId=t.message.userId?t.message.userId:this.userId,"group"==e&&(this.groupId&&(t.message.groupId=this.groupId),this.groupTraits&&(t.message.traits=Object.assign({},this.groupTraits))),n&&this.processOptionsParam(t,n),f(JSON.stringify(t));var i=t.message.integrations;this.clientIntegrationObjects&&this.clientIntegrationObjects.forEach((function(n){f("called in normal flow"),(i[n.name]||null==i[n.name]&&i.All)&&(n.isFailed&&n.isFailed()||n[e](t))})),this.clientIntegrationObjects||(f("pushing in replay queue"),this.toBeProcessedByIntegrationArray.push([e,t])),Mn.call(this,t,e),f(e+" is called "),r&&r()}catch(e){m(e)}}},{key:"processOptionsParam",value:function(e,t){var n=["integrations","anonymousId","originalTimestamp"];for(var r in t)if(n.includes(r))e.message[r]=t[r];else if("context"!==r)e.message.context[r]=t[r];else for(var i in t[r])e.message.context[i]=t[r][i]}},{key:"getPageProperties",value:function(e){var t=v();for(var n in t)void 0===e[n]&&(e[n]=t[n]);return e}},{key:"reset",value:function(){this.userId="",this.userTraits={},this.anonymousId=this.setAnonymousId(),this.storage.clear()}},{key:"getAnonymousId",value:function(){return this.anonymousId=this.storage.getAnonymousId(),this.anonymousId||this.setAnonymousId(),this.anonymousId}},{key:"setAnonymousId",value:function(e){this.anonymousId=e||g(),this.storage.setAnonymousId(this.anonymousId)}},{key:"load",value:function(e,t,n){var r="https://api.rudderlabs.com/sourceConfig";if(!e||!t||0==t.length)throw m({message:"[Analytics] load:: Unable to load due to wrong writeKey or serverUrl"}),Error("failed to initialize");n&&n.logLevel&&d(n.logLevel),n&&n.configUrl&&(r=n.configUrl),f("inside load "),this.eventRepository.writeKey=e,t&&(this.eventRepository.url=t),n&&n.valTrackingList&&n.valTrackingList.push==Array.prototype.push&&(this.trackValues=n.valTrackingList),n&&n.useAutoTracking&&(this.autoTrackFeatureEnabled=!0,this.autoTrackFeatureEnabled&&!this.autoTrackHandlersRegistered&&(Tn(this),this.autoTrackHandlersRegistered=!0,f("autoTrackHandlersRegistered",this.autoTrackHandlersRegistered)));try{!function(e,t,n,r){var i,o=r.bind(e);(i=new XMLHttpRequest).open("GET",t,!0),i.setRequestHeader("Authorization","Basic "+btoa(n+":")),i.onload=function(){var e=i.status;200==e?(f("status 200 calling callback"),o(200,i.responseText)):(m(new Error("request failed with status: "+i.status+" for url: "+t)),o(e))},i.send()}(this,r,e,this.processResponse)}catch(e){m(e),this.autoTrackFeatureEnabled&&!this.autoTrackHandlersRegistered&&Tn(Fn)}}},{key:"ready",value:function(e){"function"!=typeof e?p("ready callback is not a function"):this.readyCallback=e}},{key:"registerCallbacks",value:function(){var e=this;Object.keys(this.methodToCallbackMapping).forEach((function(t){if(e.methodToCallbackMapping.hasOwnProperty(t)){var n=window.rudderanalytics&&"function"==typeof window.rudderanalytics[e.methodToCallbackMapping[t]]?window.rudderanalytics[e.methodToCallbackMapping[t]]:function(){};f("registerCallbacks",t,n),e.on(t,n)}}))}}]),e}();window.addEventListener("error",(function(e){m(e)}),!0);var Fn=new Bn;vn(Fn),Fn.registerCallbacks();var Kn=!!window.rudderanalytics&&window.rudderanalytics.push==Array.prototype.push,qn=window.rudderanalytics?window.rudderanalytics[0]:[];if(qn.length>0&&"load"==qn[0]){var Gn=qn[0];qn.shift(),f("=====from init, calling method:: ",Gn),Fn[Gn].apply(Fn,u(qn))}if(Kn){for(var Hn=1;Hn<window.rudderanalytics.length;Hn++)Fn.toBeProcessedArray.push(window.rudderanalytics[Hn]);for(var Vn=0;Vn<Fn.toBeProcessedArray.length;Vn++){var zn=u(Fn.toBeProcessedArray[Vn]),Jn=zn[0];zn.shift(),f("=====from init, calling method:: ",Jn),Fn[Jn].apply(Fn,u(zn))}Fn.toBeProcessedArray=[]}var Wn=Fn.ready.bind(Fn),$n=Fn.identify.bind(Fn),Yn=Fn.page.bind(Fn),Qn=Fn.track.bind(Fn),Zn=Fn.alias.bind(Fn),Xn=Fn.group.bind(Fn),er=Fn.reset.bind(Fn),tr=Fn.load.bind(Fn),nr=Fn.initialized=!0,rr=Fn.getAnonymousId.bind(Fn),ir=Fn.setAnonymousId.bind(Fn);return e.alias=Zn,e.getAnonymousId=rr,e.group=Xn,e.identify=$n,e.initialized=nr,e.load=tr,e.page=Yn,e.ready=Wn,e.reset=er,e.setAnonymousId=ir,e.track=Qn,e}({});
