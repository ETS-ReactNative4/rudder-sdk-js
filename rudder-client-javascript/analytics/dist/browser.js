var analytics=function(e,t){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function i(e,t,r){return t&&s(e.prototype,t),r&&s(e,r),e}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return t&&""!=t?t:void 0}function h(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))}var d={TRACK:"track",PAGE:"page",IDENTIFY:"identify"},p={PRODUCTS_SEARCHED:"Products Searched",PRODUCT_LIST_VIEWED:"Product List Viewed",PRODUCT_LIST_FILTERED:"Product List Filtered",PROMOTION_VIEWED:"Promotion Viewed",PROMOTION_CLICKED:"Promotion Clicked",PRODUCT_CLICKED:"Product Clicked",PRODUCT_VIEWED:"Product Viewed",PRODUCT_ADDED:"Product Added",PRODUCT_REMOVED:"Product Removed",CART_VIEWED:"Cart Viewed",CHECKOUT_STARTED:"Checkout Started",CHECKOUT_STEP_VIEWED:"Checkout Step Viewed",CHECKOUT_STEP_COMPLETED:"Checkout Step Completed",PAYMENT_INFO_ENTERED:"Payment Info Entered",ORDER_UPDATED:"Order Updated",ORDER_COMPLETED:"Order Completed",ORDER_REFUNDED:"Order Refunded",ORDER_CANCELLED:"Order Cancelled",COUPON_ENTERED:"Coupon Entered",COUPON_APPLIED:"Coupon Applied",COUPON_DENIED:"Coupon Denied",COUPON_REMOVED:"Coupon Removed",PRODUCT_ADDED_TO_WISHLIST:"Product Added to Wishlist",PRODUCT_REMOVED_FROM_WISHLIST:"Product Removed from Wishlist",WISH_LIST_PRODUCT_ADDED_TO_CART:"Wishlist Product Added to Cart",PRODUCT_SHARED:"Product Shared",CART_SHARED:"Cart Shared",PRODUCT_REVIEWED:"Product Reviewed"},f="http://18.222.145.124:5000/dump",y=5e3;var _={HS:function(){function e(t){n(this,e),this.hubId=t}return i(e,[{key:"init",value:function(){!function(e,t){console.log("in script loader=== "+e);var r=document.createElement("script");r.src=t,r.type="text/javascript",r.id=e;var n=document.getElementsByTagName("script")[0];console.log("==script==",n),n.parentNode.insertBefore(r,n)}("hubspot-integration","http://js.hs-scripts.com/"+this.hubId+".js"),console.log("===in init===")}},{key:"identify",value:function(e){console.log("in HubspotAnalyticsManager identify");var t=e.rl_message.rl_context.rl_traits,n={};for(var s in t){if(Object.getOwnPropertyDescriptor(t,s)&&t[s])n[s.startsWith("rl_")?s.substring(3,s.length):s]=t[s]}if(n.address){var i=n.address;for(var o in delete n.address,i)if(Object.getOwnPropertyDescriptor(i,o)&&i[o]){var l=o.startsWith("rl_")?o.substring(3,o.length):o;n[l="street"==l?"address":l]=i[o]}}var a=e.rl_message.rl_context.rl_user_properties;for(var u in a){if(Object.getOwnPropertyDescriptor(a,u)&&a[u])n[u.startsWith("rl_")?u.substring(3,u.length):u]=a[u]}(console.log(n),void 0!==("undefined"==typeof window?"undefined":r(window)))&&(window._hsq=window._hsq||[]).push(["identify",n])}},{key:"track",value:function(e){console.log("in HubspotAnalyticsManager track");var t=window._hsq=window._hsq||[],r={};r.id=e.rl_message.rl_event,e.rl_message.rl_properties&&e.rl_message.rl_properties.revenue&&(console.log("revenue: "+e.rl_message.rl_properties.revenue),r.value=e.rl_message.rl_properties.revenue),t.push(["trackEvent",r])}},{key:"page",value:function(e){console.log("in HubspotAnalyticsManager page");var t=window._hsq=window._hsq||[];e.rl_message.rl_properties&&e.rl_message.rl_properties.path&&t.push(["setPath",e.rl_message.rl_properties.path]),t.push(["trackPageView"])}},{key:"loaded",value:function(){return console.log("in hubspot isLoaded"),!(!window._hsq||window._hsq.push===Array.prototype.push)}}]),e}()},g=function e(){n(this,e),this.rl_build="1.0.0",this.rl_name="RudderLabs JavaScript SDK",this.rl_namespace="com.rudderlabs.javascript",this.rl_version="1.0.0"},v=function e(){n(this,e),this.rl_name="RudderLabs JavaScript SDK",this.rl_version="1.0.0"},m=function e(){n(this,e),this.rl_name="",this.rl_version=""},E=function e(){n(this,e),this.rl_density=0,this.rl_width=0,this.rl_height=0},w=function e(){n(this,e),this.rl_app=new g,this.rl_traits=null,this.rl_library=new v;var t=new m;t.rl_version="";var r=new E;"undefined"==typeof window?(r.rl_width=0,r.rl_height=0,r.rl_density=0,t.rl_version="",t.rl_name="",this.rl_user_agent=null,this.rl_locale=null):(r.rl_width=window.width,r.rl_height=window.height,r.rl_density=window.devicePixelRatio,this.rl_user_agent=navigator.userAgent,this.rl_locale=navigator.language||navigator.browserLanguage),this.screen=r,this.rl_device=null,this.rl_network=null},O=function(){function e(){n(this,e),this.rl_channel="web",this.rl_context=new w,this.rl_type=null,this.rl_action=null,this.rl_message_id=h().toString(),this.rl_timestamp=(new Date).getTime(),this.rl_anonymous_id=h().toString(),this.rl_user_id=null,this.rl_event=null,this.rl_properties={},this.rl_integrations={},this.rl_integrations.all=!0}return i(e,[{key:"getProperty",value:function(e){return this.rl_properties[e]}},{key:"addProperty",value:function(e,t){this.rl_properties[e]=t}},{key:"validateFor",value:function(e){if(!this.rl_properties)throw new Error("Key rl_properties is required");switch(e){case d.TRACK:if(!this.rl_event)throw new Error("Key rl_event is required for track event");if(this.rl_event in Object.values(p))switch(this.rl_event){case p.CHECKOUT_STEP_VIEWED:case p.CHECKOUT_STEP_COMPLETED:case p.PAYMENT_INFO_ENTERED:this.checkForKey("checkout_id"),this.checkForKey("step");break;case p.PROMOTION_VIEWED:case p.PROMOTION_CLICKED:this.checkForKey("promotion_id");break;case p.ORDER_REFUNDED:this.checkForKey("order_id")}else this.rl_properties.rl_category||(this.rl_properties.rl_category=this.rl_event);break;case d.PAGE:break;case d.SCREEN:if(!this.rl_properties.name)throw new Error("Key 'name' is required in rl_properties")}}},{key:"checkForKey",value:function(e){if(!this.rl_properties[e])throw new Error("Key '"+e+"' is required in rl_properties")}}]),e}(),P=function(){function e(){n(this,e),this.rl_message=new O}return i(e,[{key:"setType",value:function(e){this.rl_message.rl_type=e}},{key:"setProperty",value:function(e){this.rl_message.rl_properties=e}},{key:"setUserProperty",value:function(e){this.rl_message.rl_user_properties=e}},{key:"setUserId",value:function(e){this.rl_message.rl_user_id=e}},{key:"setEventName",value:function(e){this.rl_message.rl_event=e}},{key:"updateTraits",value:function(e){this.rl_message.rl_context.rl_traits=e}},{key:"getElementContent",value:function(){return this.rl_message}}]),e}(),I=function(){function e(){n(this,e),this.rudderProperty=null,this.rudderUserProperty=null,this.event=null,this.userId=null,this.channel=null,this.type=null}return i(e,[{key:"setProperty",value:function(e){return this.rudderProperty=e,this}},{key:"setPropertyBuilder",value:function(e){return this.rudderProperty=e.build(),this}},{key:"setUserProperty",value:function(e){return this.rudderUserProperty=e,this}},{key:"setUserPropertyBuilder",value:function(e){return this.rudderUserProperty=e.build(),this}},{key:"setEvent",value:function(e){return this.event=e,this}},{key:"setUserId",value:function(e){return this.userId=e,this}},{key:"setChannel",value:function(e){return this.channel=e,this}},{key:"setType",value:function(e){return this.type=e,this}},{key:"build",value:function(){var e=new P;return e.setUserId(this.userId),e.setType(this.type),e.setEventName(this.event),e.setProperty(this.rudderProperty),e.setUserProperty(this.rudderUserProperty),e}}]),e}(),k=function(){function e(){n(this,e),this.rl_address=null,this.rl_age=null,this.rl_birthday=null,this.rl_company=null,this.rl_createdat=null,this.rl_description=null,this.rl_email=null,this.rl_firstname=null,this.rl_gender=null,this.rl_id=null,this.rl_lastname=null,this.rl_name=null,this.rl_phone=null,this.rl_title=null,this.rl_username=null}return i(e,[{key:"setAddress",value:function(e){return this.rl_address=e,this}},{key:"setAge",value:function(e){return this.rl_age=e,this}},{key:"setBirthday",value:function(e){return this.rl_birthday=e,this}},{key:"setCompany",value:function(e){return this.rl_company=e,this}},{key:"setCreatedAt",value:function(e){return this.rl_createdat=e,this}},{key:"setDescription",value:function(e){return this.rl_description=e,this}},{key:"setEmail",value:function(e){return this.rl_email=e,this}},{key:"setFirstname",value:function(e){return this.rl_firstname=e,this}},{key:"setId",value:function(e){return this.rl_id=e,this}},{key:"setLastname",value:function(e){return this.rl_lastname=e,this}},{key:"setName",value:function(e){return this.rl_name=e,this}},{key:"setPhone",value:function(e){return this.rl_phone=e,this}},{key:"setTitle",value:function(e){return this.rl_title=e,this}},{key:"setUsername",value:function(e){return this.rl_username=e,this}}]),e}(),b="rl_user_id",T="rl_trait",D=function(){function e(){n(this,e),this.storage=window.localStorage}return i(e,[{key:"setItem",value:function(e,t){var n="";"string"==typeof t&&(n=t),"object"==r(t)&&(n=JSON.stringify(t)),this.storage.setItem(e,n)}},{key:"setUserId",value:function(e){"string"==typeof e?this.storage.setItem(b,e):console.log("userId should be string")}},{key:"setUserTraits",value:function(e){"object"==r(e)?this.storage.setItem(T,JSON.stringify(e)):console.log("traits should be object")}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return JSON.parse(t)}},{key:"getUserId",value:function(){return this.storage.getItem(b)}},{key:"getUserTraits",value:function(){return JSON.parse(this.storage.getItem(T))}},{key:"removeItem",value:function(e){this.storage.removeItem(e)}},{key:"clear",value:function(){this.storage.clear()}}]),e}(),C=function e(){n(this,e),this.batch=null,this.write_key=null},R=new(function(){function e(){n(this,e),this.eventsBuffer=[],this.url=f,this.state="READY",setInterval(this.preaparePayloadAndFlush,y,this)}return i(e,[{key:"preaparePayloadAndFlush",value:function(e){if(console.log("==== in preaparePayloadAndFlush with state: "+e.state),console.log(e.eventsBuffer),0!=e.eventsBuffer.length&&"PROCESSING"!==e.state){var r,n=e.eventsBuffer.slice(0,30),s=new C;s.batch=n,s.write_key=e.write_key,s.sent_at=(r=(new Date).toISOString()).split("T")[0]+" "+r.split("T")[1].split("Z")[0].split(".")[0]+"+"+r.split("Z")[0].split(".")[1];var i=new t;console.log("==== in flush sending to Rudder BE ===="),console.log(JSON.stringify(s,c).replace(/rl_/g,"")),i.open("POST",e.url,!0),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=function(){4===i.readyState&&200===i.status?(console.log("====== request processed successfully: "+i.status),e.eventsBuffer=e.eventsBuffer.slice(30),console.log(e.eventsBuffer.length)):4===i.readyState&&200!==i.status&&console.log("====== request failed with status: "+i.status),e.state="READY"},i.send(JSON.stringify(s,c).replace(/rl_/g,"")),e.state="PROCESSING"}}},{key:"flush",value:function(e){console.log(this.eventsBuffer),this.eventsBuffer.push(e.getElementContent()),console.log("==== Added to flush queue ====="+this.eventsBuffer.length)}}]),e}()),S=function(){function e(){n(this,e),this.propertyMap={}}return i(e,[{key:"getPropertyMap",value:function(){return this.propertyMap}},{key:"getProperty",value:function(e){return this.propertyMap[e]}},{key:"setProperty",value:function(e,t){this.propertyMap[e]=t}},{key:"setPropertyMap",value:function(e){var t=this;this.propertyMap?Object.keys(e).forEach((function(r){t.propertyMap[r]=e[r]})):this.propertyMap=e}}]),e}(),A=function(e){function t(){return n(this,t),a(this,o(t).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,e),i(t,[{key:"event",value:function(){return p.PROMOTION_VIEWED}}]),t}(function(){function e(){n(this,e),this.promotion=null}return i(e,[{key:"setPromotion",value:function(e){return this.promotion=e,this}},{key:"build",value:function(){var e=new S;return e.setPropertyMap(this.promotion),e}}]),e}()),U=function(){function e(){n(this,e),this.promotion_id="",this.creative="",this.name="",this.position=0}return i(e,[{key:"setPromotionId",value:function(e){return this.promotion_id=e,this}},{key:"setCreative",value:function(e){return this.creative=e,this}},{key:"setName",value:function(e){return this.name=e,this}},{key:"setPosition",value:function(e){return this.position=e,this}}]),e}();function N(e,t){var r=this;console.log("supported intgs ",_);if(this.clientIntegrationObjects=[],e&&0!=e.length){e.forEach((function(e){var n=_[e];if("HS"===e){t[0].hubId;"6405167";var s=new n("6405167");s.init(),r.clientIntegrationObjects.push(s)}}));for(var n=function(e){r.toBeProcessedByIntegrationArray.forEach((function(t){var n,s=t[0];t.shift(),(n=r.clientIntegrationObjects[e])[s].apply(n,u(t))}))},s=0;s<this.clientIntegrationObjects.length;s++)n(s);this.toBeProcessedByIntegrationArray=[]}else this.toBeProcessedByIntegrationArray=[]}function x(e){this.eventRepository||(this.eventRepository=R),this.eventRepository.flush(e)}var j=new(function(){function e(){n(this,e),this.prop1="val1",this.prop2="val2",this.ready=!1,this.writeKey="",this.eventsBuffer=[],this.clientIntegrations=[],this.configArray=[],this.clientIntegrationObjects=void 0,this.toBeProcessedArray=[],this.toBeProcessedByIntegrationArray=[],this.storage=new D,this.userId=null!=this.storage.getUserId()?this.storage.getUserId():h(),this.userTraits=null!=this.storage.getUserTraits()?this.storage.getUserTraits():{},this.storage.setUserId(this.userId),this.eventRepository=R}return i(e,[{key:"processResponse",value:function(e,t){(t=JSON.parse(t)).source.destinations.forEach((function(e,t){console.log("Destination "+t+" Enabled? "+e.enabled+" Type: "+e.destinationDefinition.name+" Use Native SDK? "+e.config.useNativeSDK),e.enabled&&e.config.useNativeSDK&&(this.clientIntegrations.push(e.destinationDefinition.name),this.configArray.push(e.config))}),this),N.call(this,this.clientIntegrations,this.configArray)}},{key:"page",value:function(e,t,n,s,i){var o=Array.from(arguments);console.log("args ",o),"function"==typeof s&&(i=s,s=null),"function"==typeof n&&(i=n,s=n=null),"function"==typeof t&&(i=t,s=n=t=null),"object"===r(e)&&(s=t,n=e,t=e=null),"object"===r(t)&&(s=n,n=t,t=null),"string"==typeof e&&"string"!=typeof t&&(t=e,e=null),this.userId||(this.userId=h(),this.storage.setUserId(this.userId));var l=(new I).setType("page").build();t&&(console.log("name ",t),l.rl_message.rl_name=t),e&&(n||(n={}),n.category=e),n&&(console.log(JSON.parse(JSON.stringify(n))),l.rl_message.rl_properties=n),l.rl_message.rl_context.rl_traits=this.userTraits,l.rl_message.rl_anonymous_id=l.rl_message.rl_user_id=l.rl_message.rl_context.rl_traits.rl_anonymous_id=this.userId,console.log(JSON.stringify(l)),this.clientIntegrationObjects&&this.clientIntegrationObjects.forEach((function(e){e.page(l)})),this.clientIntegrationObjects||this.toBeProcessedByIntegrationArray.push(["page",l]),x.call(this,l),console.log("page called "+this.prop1),i&&i()}},{key:"track",value:function(e,t,r,n){"function"==typeof r&&(n=r,r=null),"function"==typeof t&&(n=t,r=null,t=null),this.userId||(this.userId=h(),this.storage.setUserId(this.userId));var s=(new I).setType("track").build();e&&s.setEventName(e),t&&s.setProperty(t),s.rl_message.rl_context.rl_traits=this.userTraits,s.rl_message.rl_anonymous_id=s.rl_message.rl_user_id=s.rl_message.rl_context.rl_traits.rl_anonymous_id=this.userId,console.log(JSON.stringify(s)),this.clientIntegrationObjects&&this.clientIntegrationObjects.forEach((function(e){console.log("called in normal flow"),e.track(s)})),this.clientIntegrationObjects||(console.log("pushing in replay queue"),this.toBeProcessedByIntegrationArray.push(["track",s])),x.call(this,s),console.log("track is called "+this.prop2),n&&n()}},{key:"identify",value:function(e,t,n,s){"function"==typeof n&&(s=n,n=null),"function"==typeof t&&(s=t,n=null,t=null),"object"==r(e)&&(n=t,t=e,e=this.userId),this.userId=e,this.storage.setUserId(this.userId);var i=(new I).setType("identify").build(),o=new k;if(console.log(t),t)for(var l in t)Object.getOwnPropertyDescriptor(t,l)&&t[l]&&(o[l]=t[l]);this.userTraits=t,this.storage.setUserTraits(this.userTraits),i.rl_message.rl_context.rl_traits=this.userTraits,i.rl_message.rl_anonymous_id=i.rl_message.rl_user_id=i.rl_message.rl_context.rl_traits.rl_anonymous_id=this.userId,console.log(JSON.stringify(i)),this.clientIntegrationObjects&&this.clientIntegrationObjects.forEach((function(e){console.log("called in normal flow"),e.identify(i)})),this.clientIntegrationObjects||(console.log("pushing in replay queue"),this.toBeProcessedByIntegrationArray.push(["identify",i])),x.call(this,i),console.log("identify is called "+this.prop2),s&&s()}},{key:"reset",value:function(){this.userId="",this.userTraits={},this.storage.clear()}},{key:"load",value:function(e){var r,n,s,i,o;console.log("inside load "+this.prop1),this.writeKey=e,r=this,n="https://api.rudderlabs.com/source-config?write_key="+e,s=this.processResponse,o=s.bind(r),(i=new t).open("GET",n,!0),i.onload=function(){var e=i.status;200==e?(console.log("status 200"),o(200,i.responseText)):o(e),console.log("in response process")},console.log("before send"),i.send(),console.log("after send")}}]),e}()),B=!!window.analytics&&window.analytics.push==Array.prototype.push,M=window.analytics?window.analytics[0]:[];if(M.length>0&&"load"==M[0]&&j[M[0]](M[1]),B){for(var K=1;K<window.analytics.length;K++)j.toBeProcessedArray.push(window.analytics[K]);for(var L=0;L<j.toBeProcessedArray.length;L++){var q=u(j.toBeProcessedArray[L]),V=q[0];q.shift(),j[V].apply(j,u(q))}j.toBeProcessedArray=[]}var F=j.identify.bind(j),H=j.page.bind(j),W=j.track.bind(j),J=j.reset.bind(j),G=j.load.bind(j);return e.ECommerceEvents=p,e.ECommercePromotion=U,e.PromotionViewedEvent=A,e.RudderElementBuilder=I,e.identify=F,e.load=G,e.page=H,e.reset=J,e.track=W,e}({},XMLHttpRequestNode);
