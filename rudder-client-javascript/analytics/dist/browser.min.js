var analytics=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,r=new Array(e.length);t<e.length;t++)r[t]=e[t];return r}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return null==t?void 0:t}function h(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var r=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?r:3&r|8).toString(16)}))}function p(e){e.message&&e.message;e instanceof Event&&e.target&&"script"==e.target.localName&&e.target.id}var l={TRACK:"track",PAGE:"page",IDENTIFY:"identify"},d={PRODUCTS_SEARCHED:"Products Searched",PRODUCT_LIST_VIEWED:"Product List Viewed",PRODUCT_LIST_FILTERED:"Product List Filtered",PROMOTION_VIEWED:"Promotion Viewed",PROMOTION_CLICKED:"Promotion Clicked",PRODUCT_CLICKED:"Product Clicked",PRODUCT_VIEWED:"Product Viewed",PRODUCT_ADDED:"Product Added",PRODUCT_REMOVED:"Product Removed",CART_VIEWED:"Cart Viewed",CHECKOUT_STARTED:"Checkout Started",CHECKOUT_STEP_VIEWED:"Checkout Step Viewed",CHECKOUT_STEP_COMPLETED:"Checkout Step Completed",PAYMENT_INFO_ENTERED:"Payment Info Entered",ORDER_UPDATED:"Order Updated",ORDER_COMPLETED:"Order Completed",ORDER_REFUNDED:"Order Refunded",ORDER_CANCELLED:"Order Cancelled",COUPON_ENTERED:"Coupon Entered",COUPON_APPLIED:"Coupon Applied",COUPON_DENIED:"Coupon Denied",COUPON_REMOVED:"Coupon Removed",PRODUCT_ADDED_TO_WISHLIST:"Product Added to Wishlist",PRODUCT_REMOVED_FROM_WISHLIST:"Product Removed from Wishlist",WISH_LIST_PRODUCT_ADDED_TO_CART:"Wishlist Product Added to Cart",PRODUCT_SHARED:"Product Shared",CART_SHARED:"Cart Shared",PRODUCT_REVIEWED:"Product Reviewed"},f="http://18.222.145.124:5000/dump",y=5e3;var v={HS:function(){function e(t){r(this,e),this.hubId=t,this.name="HS"}return s(e,[{key:"init",value:function(){!function(e,t){var r=document.createElement("script");r.src=t,r.type="text/javascript",r.id=e;var n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(r,n)}("hubspot-integration","http://js.hs-scripts.com/"+this.hubId+".js")}},{key:"identify",value:function(e){var r=e.message.context.traits,n={};for(var s in r){if(Object.getOwnPropertyDescriptor(r,s)&&r[s])n[s]=r[s]}if(n.address){var i=n.address;for(var o in delete n.address,i)if(Object.getOwnPropertyDescriptor(i,o)&&i[o]){var a=o;n[a="street"==a?"address":a]=i[o]}}var u=e.message.context.user_properties;for(var c in u){if(Object.getOwnPropertyDescriptor(u,c)&&u[c])n[c]=u[c]}void 0!==("undefined"==typeof window?"undefined":t(window))&&(window._hsq=window._hsq||[]).push(["identify",n])}},{key:"track",value:function(e){var t=window._hsq=window._hsq||[],r={};r.id=e.message.event,e.message.properties&&e.message.properties.revenue&&(r.value=e.message.properties.revenue),t.push(["trackEvent",r])}},{key:"page",value:function(e){var t=window._hsq=window._hsq||[];e.message.properties&&e.message.properties.path&&t.push(["setPath",e.message.properties.path]),t.push(["trackPageView"])}},{key:"loaded",value:function(){return!(!window._hsq||window._hsq.push===Array.prototype.push)}}]),e}(),GA:function(){function e(t){r(this,e),this.trackingID=t,this.name="GA"}return s(e,[{key:"init",value:function(){!function(e,t,r,n,s,i,o){e.GoogleAnalyticsObject=s,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,i=t.createElement(r),o=t.getElementsByTagName(r)[0],i.async=1,i.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(i,o)}(window,document,"script",0,"ga"),ga("create",this.trackingID,"auto"),ga("send","pageview")}},{key:"identify",value:function(e){ga("set","userId",e.message.anonymous_id)}},{key:"track",value:function(e){var t=e.message.event,r=e.message.event,n=e.message.event,s="";e.message.properties&&(s=e.message.properties.value?e.message.properties.value:e.message.properties.revenue),ga("send","event",{hitType:"event",eventCategory:t,eventAction:r,eventLabel:n,eventValue:s})}},{key:"page",value:function(e){var t=e.properties&&e.properties.path?e.properties.path:void 0;t&&ga("set","page",t),ga("send","pageview")}},{key:"loaded",value:function(){}}]),e}()},g=function e(){r(this,e),this.build="1.0.0",this.name="RudderLabs JavaScript SDK",this.namespace="com.rudderlabs.javascript",this.version="1.0.0"},m=function e(){r(this,e),this.name="RudderLabs JavaScript SDK",this.version="1.0.0"},E=function e(){r(this,e),this.name="",this.version=""},w=function e(){r(this,e),this.density=0,this.width=0,this.height=0},I=function e(){r(this,e),this.app=new g,this.traits=null,this.library=new m;var t=new E;t.version="";var n=new w;n.width=window.width,n.height=window.height,n.density=window.devicePixelRatio,this.userAgent=navigator.userAgent,this.locale=navigator.language||navigator.browserLanguage,this.ip="0.0.0.0",this.os=t,this.screen=n,this.device=null,this.network=null},P=function(){function e(){r(this,e),this.channel="web",this.context=new I,this.type=null,this.action=null,this.messageId=h().toString(),this.originalTimestamp=(new Date).toISOString(),this.anonymousId=h().toString(),this.userId=null,this.event=null,this.properties={},this.integrations={},this.integrations.All=!0}return s(e,[{key:"getProperty",value:function(e){return this.properties[e]}},{key:"addProperty",value:function(e,t){this.properties[e]=t}},{key:"validateFor",value:function(e){if(!this.properties)throw new Error("Key properties is required");switch(e){case l.TRACK:if(!this.event)throw new Error("Key event is required for track event");if(this.event in Object.values(d))switch(this.event){case d.CHECKOUT_STEP_VIEWED:case d.CHECKOUT_STEP_COMPLETED:case d.PAYMENT_INFO_ENTERED:this.checkForKey("checkout_id"),this.checkForKey("step");break;case d.PROMOTION_VIEWED:case d.PROMOTION_CLICKED:this.checkForKey("promotion_id");break;case d.ORDER_REFUNDED:this.checkForKey("order_id")}else this.properties.category||(this.properties.category=this.event);break;case l.PAGE:break;case l.SCREEN:if(!this.properties.name)throw new Error("Key 'name' is required in properties")}}},{key:"checkForKey",value:function(e){if(!this.properties[e])throw new Error("Key '"+e+"' is required in properties")}}]),e}(),k=function(){function e(){r(this,e),this.message=new P}return s(e,[{key:"setType",value:function(e){this.message.type=e}},{key:"setProperty",value:function(e){this.message.properties=e}},{key:"setUserProperty",value:function(e){this.message.user_properties=e}},{key:"setUserId",value:function(e){this.message.userId=e}},{key:"setEventName",value:function(e){this.message.event=e}},{key:"updateTraits",value:function(e){this.message.context.traits=e}},{key:"getElementContent",value:function(){return this.message}}]),e}(),O=function(){function e(){r(this,e),this.rudderProperty=null,this.rudderUserProperty=null,this.event=null,this.userId=null,this.channel=null,this.type=null}return s(e,[{key:"setProperty",value:function(e){return this.rudderProperty=e,this}},{key:"setPropertyBuilder",value:function(e){return this.rudderProperty=e.build(),this}},{key:"setUserProperty",value:function(e){return this.rudderUserProperty=e,this}},{key:"setUserPropertyBuilder",value:function(e){return this.rudderUserProperty=e.build(),this}},{key:"setEvent",value:function(e){return this.event=e,this}},{key:"setUserId",value:function(e){return this.userId=e,this}},{key:"setChannel",value:function(e){return this.channel=e,this}},{key:"setType",value:function(e){return this.type=e,this}},{key:"build",value:function(){var e=new k;return e.setUserId(this.userId),e.setType(this.type),e.setEventName(this.event),e.setProperty(this.rudderProperty),e.setUserProperty(this.rudderUserProperty),e}}]),e}(),b="rl_user_id",T="rl_trait",D=function(){function e(){r(this,e),this.storage=window.localStorage}return s(e,[{key:"setItem",value:function(e,r){var n="";"string"==typeof r&&(n=r),"object"==t(r)&&(n=JSON.stringify(r)),this.storage.setItem(e,n)}},{key:"setUserId",value:function(e){"string"==typeof e&&this.storage.setItem(b,e)}},{key:"setUserTraits",value:function(e){"object"==t(e)&&this.storage.setItem(T,JSON.stringify(e))}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return JSON.parse(t)}},{key:"getUserId",value:function(){return this.storage.getItem(b)}},{key:"getUserTraits",value:function(){return JSON.parse(this.storage.getItem(T))}},{key:"removeItem",value:function(e){this.storage.removeItem(e)}},{key:"clear",value:function(){this.storage.removeItem(b),this.storage.removeItem(T)}}]),e}(),_=function e(){r(this,e),this.batch=null,this.writeKey=null},R=new(function(){function e(){r(this,e),this.eventsBuffer=[],this.writeKey="",this.url=f,this.state="READY",this.batchSize=0,setInterval(this.preaparePayloadAndFlush,y,this)}return s(e,[{key:"preaparePayloadAndFlush",value:function(e){if(0!=e.eventsBuffer.length&&"PROCESSING"!==e.state){var t,r=e.eventsBuffer,n=new _;n.batch=r,n.writeKey=e.writeKey,n.sentAt=(new Date).toISOString(),n.batch.forEach((function(e){e.sentAt=n.sentAt})),e.batchSize=e.eventsBuffer.length,(t=new XMLHttpRequest).open("POST",e.url,!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Authorization","Basic "+btoa(n.writeKey+":")),t.onreadystatechange=function(){4===t.readyState&&200===t.status?e.eventsBuffer=e.eventsBuffer.slice(e.batchSize):4===t.readyState&&200!==t.status&&p(new Error("request failed with status: "+t.status+" for url: "+e.url)),e.state="READY"},t.send(JSON.stringify(n,c)),e.state="PROCESSING"}}},{key:"enqueue",value:function(e){this.eventsBuffer.push(e.getElementContent())}}]),e}()),C=function(){function e(){r(this,e),this.propertyMap={}}return s(e,[{key:"getPropertyMap",value:function(){return this.propertyMap}},{key:"getProperty",value:function(e){return this.propertyMap[e]}},{key:"setProperty",value:function(e,t){this.propertyMap[e]=t}},{key:"setPropertyMap",value:function(e){var t=this;this.propertyMap?Object.keys(e).forEach((function(r){t.propertyMap[r]=e[r]})):this.propertyMap=e}}]),e}(),S=function(e){function t(){return r(this,t),a(this,i(t).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(t,e),s(t,[{key:"event",value:function(){return d.PROMOTION_VIEWED}}]),t}(function(){function e(){r(this,e),this.promotion=null}return s(e,[{key:"setPromotion",value:function(e){return this.promotion=e,this}},{key:"build",value:function(){var e=new C;return e.setPropertyMap(this.promotion),e}}]),e}()),A=function(){function e(){r(this,e),this.promotion_id="",this.creative="",this.name="",this.position=0}return s(e,[{key:"setPromotionId",value:function(e){return this.promotion_id=e,this}},{key:"setCreative",value:function(e){return this.creative=e,this}},{key:"setName",value:function(e){return this.name=e,this}},{key:"setPosition",value:function(e){return this.position=e,this}}]),e}();function U(e){this.eventRepository||(this.eventRepository=R),this.eventRepository.enqueue(e)}var x=function(){function e(){r(this,e),this.ready=!1,this.eventsBuffer=[],this.clientIntegrations=[],this.configArray=[],this.clientIntegrationObjects=void 0,this.toBeProcessedArray=[],this.toBeProcessedByIntegrationArray=[],this.storage=new D,this.userId=null!=this.storage.getUserId()?this.storage.getUserId():h(),this.userTraits=null!=this.storage.getUserTraits()?this.storage.getUserTraits():{},this.storage.setUserId(this.userId),this.eventRepository=R}return s(e,[{key:"processResponse",value:function(e,t){(t=JSON.parse(t)).source.destinations.forEach((function(e,t){e.enabled&&e.config.useNativeSDK&&(this.clientIntegrations.push(e.destinationDefinition.name),this.configArray.push(e.config))}),this),this.init(this.clientIntegrations,this.configArray)}},{key:"init",value:function(e,t){var r=this;this.clientIntegrationObjects=[],e&&0!=e.length?(e.forEach((function(e){var n=v[e];if("HS"===e){var s=new n(t[0].hubId);s.init(),r.clientIntegrationObjects.push(s)}if("GA"===e){var i=new n(t[0].trackingID);i.init(),r.clientIntegrationObjects.push(i)}})),this.toBeProcessedByIntegrationArray.forEach((function(e){var t=e[0];e.shift();for(var n=e[0].message.integrations,s=0;s<r.clientIntegrationObjects.length;s++)if(n[r.clientIntegrationObjects[s].name]||null==n[r.clientIntegrationObjects[s].name]&&n.All)try{var i;(i=r.clientIntegrationObjects[s])[t].apply(i,u(e))}catch(e){p(e)}})),this.toBeProcessedByIntegrationArray=[]):this.toBeProcessedByIntegrationArray=[]}},{key:"page",value:function(e,r,n,s,i){"function"==typeof s&&(i=s,s=null),"function"==typeof n&&(i=n,s=n=null),"function"==typeof r&&(i=r,s=n=r=null),"object"===t(e)&&(s=r,n=e,r=e=null),"object"===t(r)&&(s=n,n=r,r=null),"string"==typeof e&&"string"!=typeof r&&(r=e,e=null),this.processPage(e,r,n,s,i)}},{key:"track",value:function(e,t,r,n){"function"==typeof r&&(n=r,r=null),"function"==typeof t&&(n=t,r=null,t=null),this.processTrack(e,t,r,n)}},{key:"identify",value:function(e,r,n,s){"function"==typeof n&&(s=n,n=null),"function"==typeof r&&(s=r,n=null,r=null),"object"==t(e)&&(n=r,r=e,e=this.userId),this.processIdentify(e,r,n,s)}},{key:"processPage",value:function(e,t,r,n,s){var i=(new O).setType("page").build();t&&(i.message.name=t),e&&(r||(r={}),r.category=e),r&&(i.message.properties=r),this.trackPage(i,n,s)}},{key:"processTrack",value:function(e,t,r,n){var s=(new O).setType("track").build();e&&s.setEventName(e),t?s.setProperty(t):s.setProperty({}),this.trackEvent(s,r,n)}},{key:"processIdentify",value:function(e,t,r,n){this.userId=e,this.storage.setUserId(this.userId);var s=(new O).setType("identify").build();t&&(this.userTraits=t,this.storage.setUserTraits(this.userTraits)),this.identifyUser(s,r,n)}},{key:"identifyUser",value:function(e,t,r){e.message.userId&&(this.userId=e.message.userId,this.storage.setUserId(this.userId)),e&&e.message&&e.message.context&&e.message.context.traits&&(this.userTraits=e.message.context.traits,this.storage.setUserTraits(this.userTraits)),this.processAndSendDataToDestinations("identify",e,t,r)}},{key:"trackPage",value:function(e,t,r){this.processAndSendDataToDestinations("page",e,t,r)}},{key:"trackEvent",value:function(e,t,r){this.processAndSendDataToDestinations("track",e,t,r)}},{key:"processAndSendDataToDestinations",value:function(e,t,r,n){try{this.userId||(this.userId=h(),this.storage.setUserId(this.userId)),t.message.context.traits=this.userTraits,t.message.anonymousId=t.message.userId=t.message.context.traits.anonymousId=this.userId,r&&this.processOptionsParam(t,r);var s=t.message.integrations;this.clientIntegrationObjects&&this.clientIntegrationObjects.forEach((function(r){(s[r.name]||null==s[r.name]&&s.All)&&r[e](t)})),this.clientIntegrationObjects||this.toBeProcessedByIntegrationArray.push([e,t]),U.call(this,t),n&&n()}catch(e){p(e)}}},{key:"processOptionsParam",value:function(e,t){var r=["integrations","anonymousId","originalTimestamp"];for(var n in t)if(r.includes(n))e.message[n]=t[n];else if("context"!==n)e.message.context[n]=t[n];else for(var s in t[n])e.message.context[s]=t[n][s]}},{key:"reset",value:function(){this.userId="",this.userTraits={},this.storage.clear()}},{key:"load",value:function(e,t){this.eventRepository.writeKey=e,t&&(this.eventRepository.url=t),function(e,t,r,n){var s,i=n.bind(e);(s=new XMLHttpRequest).open("GET",t,!0),s.setRequestHeader("Authorization","Basic "+btoa(r+":")),s.onload=function(){var e=s.status;200==e?i(200,s.responseText):(p(new Error("request failed with status: "+s.status+" for url: "+t)),i(e))},s.send()}(this,"https://api.rudderlabs.com/sourceConfig",e,this.processResponse)}}]),e}();window.addEventListener("error",(function(e){p(e)}),!0);var N=new x,j=!!window.analytics&&window.analytics.push==Array.prototype.push,B=window.analytics?window.analytics[0]:[];if(B.length>0&&"load"==B[0]){var K=B[0];B.shift(),N[K].apply(N,u(B))}if(j){for(var M=1;M<window.analytics.length;M++)N.toBeProcessedArray.push(window.analytics[M]);for(var L=0;L<N.toBeProcessedArray.length;L++){var q=u(N.toBeProcessedArray[L]),V=q[0];q.shift(),N[V].apply(N,u(q))}N.toBeProcessedArray=[]}var H=N.identify.bind(N),F=N.page.bind(N),W=N.track.bind(N),G=N.trackEvent.bind(N),J=N.trackPage.bind(N),z=N.identifyUser.bind(N),Y=N.reset.bind(N),X=N.load.bind(N);return e.ECommerceEvents=d,e.ECommercePromotion=A,e.PromotionViewedEvent=S,e.RudderElementBuilder=O,e.identify=H,e.identifyUser=z,e.load=X,e.page=F,e.reset=Y,e.track=W,e.trackEvent=G,e.trackPage=J,e}({});
