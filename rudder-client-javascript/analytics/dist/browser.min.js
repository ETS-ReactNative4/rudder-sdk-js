var analytics=function(e){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function o(e,t){return(o=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function a(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function u(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function c(e,t){return null==t?void 0:t}function h(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)}))}var p={TRACK:"track",PAGE:"page",IDENTIFY:"identify"},l={PRODUCTS_SEARCHED:"Products Searched",PRODUCT_LIST_VIEWED:"Product List Viewed",PRODUCT_LIST_FILTERED:"Product List Filtered",PROMOTION_VIEWED:"Promotion Viewed",PROMOTION_CLICKED:"Promotion Clicked",PRODUCT_CLICKED:"Product Clicked",PRODUCT_VIEWED:"Product Viewed",PRODUCT_ADDED:"Product Added",PRODUCT_REMOVED:"Product Removed",CART_VIEWED:"Cart Viewed",CHECKOUT_STARTED:"Checkout Started",CHECKOUT_STEP_VIEWED:"Checkout Step Viewed",CHECKOUT_STEP_COMPLETED:"Checkout Step Completed",PAYMENT_INFO_ENTERED:"Payment Info Entered",ORDER_UPDATED:"Order Updated",ORDER_COMPLETED:"Order Completed",ORDER_REFUNDED:"Order Refunded",ORDER_CANCELLED:"Order Cancelled",COUPON_ENTERED:"Coupon Entered",COUPON_APPLIED:"Coupon Applied",COUPON_DENIED:"Coupon Denied",COUPON_REMOVED:"Coupon Removed",PRODUCT_ADDED_TO_WISHLIST:"Product Added to Wishlist",PRODUCT_REMOVED_FROM_WISHLIST:"Product Removed from Wishlist",WISH_LIST_PRODUCT_ADDED_TO_CART:"Wishlist Product Added to Cart",PRODUCT_SHARED:"Product Shared",CART_SHARED:"Cart Shared",PRODUCT_REVIEWED:"Product Reviewed"},d="http://18.222.145.124:5000/dump",f=5e3;var y={HS:function(){function e(t){n(this,e),this.hubId=t,this.name="HS"}return i(e,[{key:"init",value:function(){!function(e,t){var n=document.createElement("script");n.src=t,n.type="text/javascript",n.id=e;var r=document.getElementsByTagName("script")[0];r.parentNode.insertBefore(n,r)}("hubspot-integration","http://js.hs-scripts.com/"+this.hubId+".js")}},{key:"identify",value:function(e){var n=e.message.context.traits,r={};for(var i in n){if(Object.getOwnPropertyDescriptor(n,i)&&n[i])r[i]=n[i]}if(r.address){var s=r.address;for(var o in delete r.address,s)if(Object.getOwnPropertyDescriptor(s,o)&&s[o]){var a=o;r[a="street"==a?"address":a]=s[o]}}var u=e.message.context.user_properties;for(var c in u){if(Object.getOwnPropertyDescriptor(u,c)&&u[c])r[c]=u[c]}void 0!==("undefined"==typeof window?"undefined":t(window))&&(window._hsq=window._hsq||[]).push(["identify",r])}},{key:"track",value:function(e){var t=window._hsq=window._hsq||[],n={};n.id=e.message.event,e.message.properties&&e.message.properties.revenue&&(n.value=e.message.properties.revenue),t.push(["trackEvent",n])}},{key:"page",value:function(e){var t=window._hsq=window._hsq||[];e.message.properties&&e.message.properties.path&&t.push(["setPath",e.message.properties.path]),t.push(["trackPageView"])}},{key:"loaded",value:function(){return!(!window._hsq||window._hsq.push===Array.prototype.push)}}]),e}(),GA:function(){function e(t){n(this,e),this.trackingID=t,this.name="GA"}return i(e,[{key:"init",value:function(){!function(e,t,n,r,i,s,o){e.GoogleAnalyticsObject=i,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,s=t.createElement(n),o=t.getElementsByTagName(n)[0],s.async=1,s.src="https://www.google-analytics.com/analytics.js",o.parentNode.insertBefore(s,o)}(window,document,"script",0,"ga"),ga("create",this.trackingID,"auto"),ga("send","pageview")}},{key:"identify",value:function(e){ga("set","userId",e.message.anonymous_id)}},{key:"track",value:function(e){var t=e.message.event,n=e.message.event,r=e.message.event,i="";e.message.properties&&(i=e.message.properties.value?e.message.properties.value:e.message.properties.revenue),ga("send","event",{hitType:"event",eventCategory:t,eventAction:n,eventLabel:r,eventValue:i})}},{key:"page",value:function(e){var t=e.properties&&e.properties.path?e.properties.path:void 0;t&&ga("set","page",t),ga("send","pageview")}},{key:"loaded",value:function(){}}]),e}()},v=function e(){n(this,e),this.build="1.0.0",this.name="RudderLabs JavaScript SDK",this.namespace="com.rudderlabs.javascript",this.version="1.0.0"},g=function e(){n(this,e),this.name="RudderLabs JavaScript SDK",this.version="1.0.0"},m=function e(){n(this,e),this.name="",this.version=""},E=function e(){n(this,e),this.density=0,this.width=0,this.height=0},w=function e(){n(this,e),this.app=new v,this.traits=null,this.library=new g;var t=new m;t.version="";var r=new E;r.width=window.width,r.height=window.height,r.density=window.devicePixelRatio,this.userAgent=navigator.userAgent,this.locale=navigator.language||navigator.browserLanguage,this.ip="0.0.0.0",this.os=t,this.screen=r,this.device=null,this.network=null},I=function(){function e(){n(this,e),this.channel="web",this.context=new w,this.type=null,this.action=null,this.messageId=h().toString(),this.originalTimestamp=(new Date).toISOString(),this.anonymousId=h().toString(),this.userId=null,this.event=null,this.properties={},this.integrations={},this.integrations.All=!0}return i(e,[{key:"getProperty",value:function(e){return this.properties[e]}},{key:"addProperty",value:function(e,t){this.properties[e]=t}},{key:"validateFor",value:function(e){if(!this.properties)throw new Error("Key properties is required");switch(e){case p.TRACK:if(!this.event)throw new Error("Key event is required for track event");if(this.event in Object.values(l))switch(this.event){case l.CHECKOUT_STEP_VIEWED:case l.CHECKOUT_STEP_COMPLETED:case l.PAYMENT_INFO_ENTERED:this.checkForKey("checkout_id"),this.checkForKey("step");break;case l.PROMOTION_VIEWED:case l.PROMOTION_CLICKED:this.checkForKey("promotion_id");break;case l.ORDER_REFUNDED:this.checkForKey("order_id")}else this.properties.category||(this.properties.category=this.event);break;case p.PAGE:break;case p.SCREEN:if(!this.properties.name)throw new Error("Key 'name' is required in properties")}}},{key:"checkForKey",value:function(e){if(!this.properties[e])throw new Error("Key '"+e+"' is required in properties")}}]),e}(),P=function(){function e(){n(this,e),this.message=new I}return i(e,[{key:"setType",value:function(e){this.message.type=e}},{key:"setProperty",value:function(e){this.message.properties=e}},{key:"setUserProperty",value:function(e){this.message.user_properties=e}},{key:"setUserId",value:function(e){this.message.userId=e}},{key:"setEventName",value:function(e){this.message.event=e}},{key:"updateTraits",value:function(e){this.message.context.traits=e}},{key:"getElementContent",value:function(){return this.message}}]),e}(),k=function(){function e(){n(this,e),this.rudderProperty=null,this.rudderUserProperty=null,this.event=null,this.userId=null,this.channel=null,this.type=null}return i(e,[{key:"setProperty",value:function(e){return this.rudderProperty=e,this}},{key:"setPropertyBuilder",value:function(e){return this.rudderProperty=e.build(),this}},{key:"setUserProperty",value:function(e){return this.rudderUserProperty=e,this}},{key:"setUserPropertyBuilder",value:function(e){return this.rudderUserProperty=e.build(),this}},{key:"setEvent",value:function(e){return this.event=e,this}},{key:"setUserId",value:function(e){return this.userId=e,this}},{key:"setChannel",value:function(e){return this.channel=e,this}},{key:"setType",value:function(e){return this.type=e,this}},{key:"build",value:function(){var e=new P;return e.setUserId(this.userId),e.setType(this.type),e.setEventName(this.event),e.setProperty(this.rudderProperty),e.setUserProperty(this.rudderUserProperty),e}}]),e}(),O="rl_user_id",b="rl_trait",T=function(){function e(){n(this,e),this.storage=window.localStorage}return i(e,[{key:"setItem",value:function(e,n){var r="";"string"==typeof n&&(r=n),"object"==t(n)&&(r=JSON.stringify(n)),this.storage.setItem(e,r)}},{key:"setUserId",value:function(e){"string"==typeof e&&this.storage.setItem(O,e)}},{key:"setUserTraits",value:function(e){"object"==t(e)&&this.storage.setItem(b,JSON.stringify(e))}},{key:"getItem",value:function(e){var t=this.storage.getItem(e);return JSON.parse(t)}},{key:"getUserId",value:function(){return this.storage.getItem(O)}},{key:"getUserTraits",value:function(){return JSON.parse(this.storage.getItem(b))}},{key:"removeItem",value:function(e){this.storage.removeItem(e)}},{key:"clear",value:function(){this.storage.removeItem(O),this.storage.removeItem(b)}}]),e}(),D=function e(){n(this,e),this.batch=null,this.writeKey=null},_=new(function(){function e(){n(this,e),this.eventsBuffer=[],this.writeKey="",this.url=d,this.state="READY",this.batchSize=0,setInterval(this.preaparePayloadAndFlush,f,this)}return i(e,[{key:"preaparePayloadAndFlush",value:function(e){if(0!=e.eventsBuffer.length&&"PROCESSING"!==e.state){var t,n=e.eventsBuffer,r=new D;r.batch=n,r.writeKey=e.writeKey,r.sentAt=(new Date).toISOString(),r.batch.forEach((function(e){e.sentAt=r.sentAt})),e.batchSize=e.eventsBuffer.length,(t=new XMLHttpRequest).open("POST",e.url,!0),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Authorization","Basic "+btoa(r.writeKey+":")),t.onreadystatechange=function(){4===t.readyState&&200===t.status?e.eventsBuffer=e.eventsBuffer.slice(e.batchSize):4===t.readyState&&t.status,e.state="READY"},t.send(JSON.stringify(r,c)),e.state="PROCESSING"}}},{key:"enqueue",value:function(e){this.eventsBuffer.push(e.getElementContent())}}]),e}()),R=function(){function e(){n(this,e),this.propertyMap={}}return i(e,[{key:"getPropertyMap",value:function(){return this.propertyMap}},{key:"getProperty",value:function(e){return this.propertyMap[e]}},{key:"setProperty",value:function(e,t){this.propertyMap[e]=t}},{key:"setPropertyMap",value:function(e){var t=this;this.propertyMap?Object.keys(e).forEach((function(n){t.propertyMap[n]=e[n]})):this.propertyMap=e}}]),e}(),C=function(e){function t(){return n(this,t),a(this,s(t).call(this))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&o(e,t)}(t,e),i(t,[{key:"event",value:function(){return l.PROMOTION_VIEWED}}]),t}(function(){function e(){n(this,e),this.promotion=null}return i(e,[{key:"setPromotion",value:function(e){return this.promotion=e,this}},{key:"build",value:function(){var e=new R;return e.setPropertyMap(this.promotion),e}}]),e}()),S=function(){function e(){n(this,e),this.promotion_id="",this.creative="",this.name="",this.position=0}return i(e,[{key:"setPromotionId",value:function(e){return this.promotion_id=e,this}},{key:"setCreative",value:function(e){return this.creative=e,this}},{key:"setName",value:function(e){return this.name=e,this}},{key:"setPosition",value:function(e){return this.position=e,this}}]),e}();function A(e){this.eventRepository||(this.eventRepository=_),this.eventRepository.enqueue(e)}var U=new(function(){function e(){n(this,e),this.ready=!1,this.eventsBuffer=[],this.clientIntegrations=[],this.configArray=[],this.clientIntegrationObjects=void 0,this.toBeProcessedArray=[],this.toBeProcessedByIntegrationArray=[],this.storage=new T,this.userId=null!=this.storage.getUserId()?this.storage.getUserId():h(),this.userTraits=null!=this.storage.getUserTraits()?this.storage.getUserTraits():{},this.storage.setUserId(this.userId),this.eventRepository=_}return i(e,[{key:"processResponse",value:function(e,t){(t=JSON.parse(t)).source.destinations.forEach((function(e,t){e.enabled&&e.config.useNativeSDK&&(this.clientIntegrations.push(e.destinationDefinition.name),this.configArray.push(e.config))}),this),this.init(this.clientIntegrations,this.configArray)}},{key:"init",value:function(e,t){var n=this;this.clientIntegrationObjects=[],e&&0!=e.length?(e.forEach((function(e){var r=y[e];if("HS"===e){var i=new r(t[0].hubId);i.init(),n.clientIntegrationObjects.push(i)}if("GA"===e){var s=new r(t[0].trackingID);s.init(),n.clientIntegrationObjects.push(s)}})),this.toBeProcessedByIntegrationArray.forEach((function(e){var t=e[0];e.shift();for(var r=e[0].message.integrations,i=0;i<n.clientIntegrationObjects.length;i++){var s;if(r[n.clientIntegrationObjects[i].name]||null==r[n.clientIntegrationObjects[i].name]&&r.All)(s=n.clientIntegrationObjects[i])[t].apply(s,u(e))}})),this.toBeProcessedByIntegrationArray=[]):this.toBeProcessedByIntegrationArray=[]}},{key:"page",value:function(e,n,r,i,s){"function"==typeof i&&(s=i,i=null),"function"==typeof r&&(s=r,i=r=null),"function"==typeof n&&(s=n,i=r=n=null),"object"===t(e)&&(i=n,r=e,n=e=null),"object"===t(n)&&(i=r,r=n,n=null),"string"==typeof e&&"string"!=typeof n&&(n=e,e=null),this.processPage(e,n,r,i,s)}},{key:"track",value:function(e,t,n,r){"function"==typeof n&&(r=n,n=null),"function"==typeof t&&(r=t,n=null,t=null),this.processTrack(e,t,n,r)}},{key:"identify",value:function(e,n,r,i){"function"==typeof r&&(i=r,r=null),"function"==typeof n&&(i=n,r=null,n=null),"object"==t(e)&&(r=n,n=e,e=this.userId),this.processIdentify(e,n,r,i)}},{key:"processPage",value:function(e,t,n,r,i){var s=(new k).setType("page").build();t&&(s.message.name=t),e&&(n||(n={}),n.category=e),n&&(s.message.properties=n),this.trackPage(s,r,i)}},{key:"processTrack",value:function(e,t,n,r){var i=(new k).setType("track").build();e&&i.setEventName(e),t?i.setProperty(t):i.setProperty({}),this.trackEvent(i,n,r)}},{key:"processIdentify",value:function(e,t,n,r){this.userId=e,this.storage.setUserId(this.userId);var i=(new k).setType("identify").build();t&&(this.userTraits=t,this.storage.setUserTraits(this.userTraits)),this.identifyUser(i,n,r)}},{key:"identifyUser",value:function(e,t,n){e.message.userId&&(this.userId=e.message.userId,this.storage.setUserId(this.userId)),e&&e.message&&e.message.context&&e.message.context.traits&&(this.userTraits=e.message.context.traits,this.storage.setUserTraits(this.userTraits)),this.processAndSendDataToDestinations("identify",e,t,n)}},{key:"trackPage",value:function(e,t,n){this.processAndSendDataToDestinations("page",e,t,n)}},{key:"trackEvent",value:function(e,t,n){this.processAndSendDataToDestinations("track",e,t,n)}},{key:"processAndSendDataToDestinations",value:function(e,t,n,r){this.userId||(this.userId=h(),this.storage.setUserId(this.userId)),t.message.context.traits=this.userTraits,t.message.anonymousId=t.message.userId=t.message.context.traits.anonymousId=this.userId,n&&this.processOptionsParam(t,n);var i=t.message.integrations;this.clientIntegrationObjects&&this.clientIntegrationObjects.forEach((function(n){(i[n.name]||null==i[n.name]&&i.All)&&n[e](t)})),this.clientIntegrationObjects||this.toBeProcessedByIntegrationArray.push([e,t]),A.call(this,t),r&&r()}},{key:"processOptionsParam",value:function(e,t){var n=["integrations","anonymousId","originalTimestamp"];for(var r in t)if(n.includes(r))e.message[r]=t[r];else if("context"!==r)e.message.context[r]=t[r];else for(var i in t[r])e.message.context[i]=t[r][i]}},{key:"reset",value:function(){this.userId="",this.userTraits={},this.storage.clear()}},{key:"load",value:function(e,t){this.eventRepository.writeKey=e,t&&(this.eventRepository.url=t),function(e,t,n,r){var i,s=r.bind(e);(i=new XMLHttpRequest).open("GET",t,!0),i.setRequestHeader("Authorization","Basic "+btoa(n+":")),i.onload=function(){var e=i.status;200==e?s(200,i.responseText):s(e)},i.send()}(this,"https://api.rudderlabs.com/sourceConfig",e,this.processResponse)}}]),e}()),x=!!window.analytics&&window.analytics.push==Array.prototype.push,N=window.analytics?window.analytics[0]:[];if(N.length>0&&"load"==N[0]){var j=N[0];N.shift(),U[j].apply(U,u(N))}if(x){for(var B=1;B<window.analytics.length;B++)U.toBeProcessedArray.push(window.analytics[B]);for(var K=0;K<U.toBeProcessedArray.length;K++){var M=u(U.toBeProcessedArray[K]),L=M[0];M.shift(),U[L].apply(U,u(M))}U.toBeProcessedArray=[]}var q=U.identify.bind(U),V=U.page.bind(U),H=U.track.bind(U),F=U.trackEvent.bind(U),W=U.trackPage.bind(U),G=U.identifyUser.bind(U),J=U.reset.bind(U),z=U.load.bind(U);return e.ECommerceEvents=l,e.ECommercePromotion=S,e.PromotionViewedEvent=C,e.RudderElementBuilder=k,e.identify=q,e.identifyUser=G,e.load=z,e.page=V,e.reset=J,e.track=H,e.trackEvent=F,e.trackPage=W,e}({});
